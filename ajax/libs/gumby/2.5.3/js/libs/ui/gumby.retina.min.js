!function(){"use strict";function i(i){Gumby.debug("Initializing Retina",i),this.$el=i,this.imageSrc=this.$el.attr("src"),this.retinaSrc=this.fetchRetinaImage(),this.$retinaImg=$(new Image);var t=this;return this.retinaSrc?void this.$retinaImg.attr("src",this.retinaSrc).load(function(){t.retinaImageLoaded()}).error(function(){Gumby.error("Couln't load retina image: "+t.retinaSrc)}):!1}i.prototype.fetchRetinaImage=function(){var i=this.imageSrc,t=this.imageSrc.search(/(\.|\/)(gif|jpe?g|png)$/i);return 0>t?!1:i.substr(0,t)+"@2x"+i.substr(t,i.length)},i.prototype.retinaImageLoaded=function(){Gumby.debug("Swapping image for retina version",this.$el),Gumby.debug("Triggering onRetina event",this.$el),this.$el.attr("src",this.$retinaImg.attr("src")).trigger("gumby.onRetina")},Gumby.addInitalisation("retina",function(){!window.devicePixelRatio||window.devicePixelRatio<=1||$("img[data-retina],img[gumby-retina],img[retina]").each(function(){var t=$(this);return t.data("isRetina")?!0:(t.data("isRetina",!0),void new i(t))})}),Gumby.UIModule({module:"retina",events:["onRetina"],init:function(){Gumby.initialize("retina")}})}();