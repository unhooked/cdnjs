/*! Native Promise Only
    v0.1.1-a (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function(t,e,i){"undefined"!=typeof module&&module.exports?module.exports=i():"function"==typeof define&&define.amd?define(i):e[t]=e[t]||i(t,e)}("Promise",this,function(){"use strict";function t(t){p?(p=!1,t()):"undefined"!=typeof setImmediate?setImmediate(t):setTimeout(t,0)}function e(t){var e;return null===t||"object"!=typeof t&&"function"!=typeof t||(e=t.then),"function"==typeof e?e:!1}function i(){if(0===this.state)return p=!1;var t,i,n,r,s;for(1===this.state&&(s=this.success,this.failure.length=0),2===this.state&&(s=this.failure,this.success.length=0);(t=s.shift())||t===!1;){r=this.chained.shift();try{t===!1?(p=!0,r.reject(this.msg)):(i=t===!0?this.msg:t(this.msg),p=!0,i===r.promise?r.reject(TypeError("Promise-chain cycle")):(n=e(i))?n.call(i,r.resolve,r.reject):r.resolve(i))}catch(o){p=!0,r.reject(o)}}}function n(r){var o,c,u;if(this.def){if(this.triggered)return p=!1;this.triggered=!0,c=this.def}else c=this;if(0!==c.state)return p=!1;u={def:c,triggered:!1};try{(o=e(r))?o.call(r,n.bind(u),s.bind(u)):(c.msg=r,c.state=1,t(i.bind(c)))}catch(f){s.call(u,f)}}function r(t){return this.triggered?void(p=!1):(this.triggered=!0,void n.call(this,t))}function s(e){var n;if(this.def){if(this.triggered)return p=!1;this.triggered=!0,n=this.def}else n=this;return 0!==n.state?p=!1:(n.msg=e,n.state=2,void t(i.bind(n)))}function o(t){return this.triggered?void(p=!1):(this.triggered=!0,void s.call(this,t))}function c(t,e){this.chained.push({resolve:t,reject:e})}function u(e,n){this.success.push("function"==typeof e?e:!0),this.failure.push("function"==typeof n?n:!1);var r=new h(c.bind(this));return this.chained[this.chained.length-1].promise=r,t(i.bind(this)),r}function f(t){return this.promise.then(void 0,t)}function h(t){if("function"!=typeof t)throw TypeError("Expected function argument");var e={promise:this,state:0,triggered:!1,success:[],failure:[],chained:[]};this.then=u.bind(e),this["catch"]=f.bind(e);try{t(r.bind(e),o.bind(e))}catch(i){s.call(e,i)}}function d(t,e){p=!0,t(e)}function a(t){return Array.isArray(t)?void 0:h.reject(TypeError("Expected array argument"))}function l(t){if(t!==h)throw TypeError("Expected Promise() constructor")}function g(t,e,i){t.forEach(function(t,n){h.resolve(t).then(e.bind(null,n),i)})}h.resolve=function(e){return l(this),"object"==typeof e&&e instanceof h?e:new h(function(i){t(d.bind(null,i,e))})},h.reject=function(t){return l(this),new h(function(e,i){i(t)})},h.all=function(t){var e;return l(this),(e=a(t))?e:0===t.length?h.resolve([]):new h(function(e,i){function n(t,i){r[t]=i,s++,s===o&&d(e,r)}var r=[],s=0,o=t.length;g(t,n,i)})},h.race=function(t){var e;return l(this),(e=a(t))?e:new h(function(e,i){g(t,function(t,i){d(e,i)},i)})},Object.defineProperty&&Object.defineProperty(h,"prototype",{value:Object.defineProperty({},"constructor",{writable:!0,configurable:!0,value:h})});var p=!1;return h});
