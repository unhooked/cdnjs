/*! Native Promise Only
    v0.4.0-g (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function(t,e,n){e[t]=e[t]||n(),"undefined"!=typeof module&&module.exports?module.exports=e[t]:"function"==typeof define&&define.amd&&define(function(){return e[t]})}("Promise","undefined"!=typeof global?global:this,function(){"use strict";function t(){function t(t,e){this.fn=t,this.self=e,this.next=void 0}var e,n,r;return{add:function(i,o){r=new t(i,o),n?n.next=r:e=r,n=r,r=void 0},drain:function(){for(;e;)e.fn.call(e.self),e=e.next;d=n=e}}}function e(t,e){g?(g=!1,t.call(e)):(h.add(t,e),d||(d=p(h.drain)))}function n(t){var e,n=typeof t;return null===t||"object"!==n&&"function"!==n||(e=t.then),"function"==typeof e?e:!1}function r(){var t,e,r,i,o,c=this;if(0===c.state)return g=!1;for(o=0;o<c.chain.length;o++){i=c.chain[o],t=1===c.state?i.success:i.failure;try{t===!1?(g=!0,i.reject(c.msg)):(e=t===!0?c.msg:t.call(void 0,c.msg),g=!0,e===i.promise?i.reject(TypeError("Promise-chain cycle")):(r=n(e))?r.call(e,i.resolve,i.reject):i.resolve(e))}catch(f){g=!0,i.reject(f)}}c.chain.length=0}function i(t){var c,f,u=this;if(u.def){if(u.triggered)return g=!1;u.triggered=!0,u=u.def}if(0!==u.state)return g=!1;f={def:u,triggered:!1};try{(c=n(t))?c.call(t,function(){i.apply(f,arguments)},function(){o.apply(f,arguments)}):(u.msg=t,u.state=1,e(r,u))}catch(a){o.call(f,a)}}function o(t){var n=this;if(n.def){if(n.triggered)return g=!1;n.triggered=!0,n=n.def}return 0!==n.state?g=!1:(n.msg=t,n.state=2,void e(r,n))}function c(t,e){g=!0,t(e)}function f(t,e,n,r){for(var i=0;i<e.length;i++)t.resolve(e[i]).then(function(t){n(i,t)},r)}function u(t,e){return Array.isArray(e)?void 0:t.reject(TypeError("Not an array"))}function a(t,e){if("function"!=typeof t)throw TypeError("Not a function");if("function"!=typeof e)throw TypeError("Not a function")}function s(t){this.promise=t,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function l(t){if("function"!=typeof t)throw TypeError("Not a function");var n=this,c=new s(n);v(n,"then",function(t,n){var i={success:"function"==typeof t?t:!0,failure:"function"==typeof n?n:!1};return i.promise=new l(function(t,e){a(t,e),i.resolve=t,i.reject=e}),c.chain.push(i),e(r,c),i.promise}),v(n,"catch",function(t){return c.promise.then(void 0,t)});try{t.call(void 0,function(t){return c.triggered?void(g=!1):(c.triggered=!0,void i.call(c,t))},function(t){return c.triggered?void(g=!1):(c.triggered=!0,void o.call(c,t))})}catch(f){o.call(c,f)}}var d,h,g=!1,p="undefined"!=typeof setImmediate?function(t){return setImmediate(t)}:setTimeout,v=Object.defineProperty?function(t,e,n,r){return Object.defineProperty(t,e,{value:n,writable:!0,configurable:r!==!1})}:function(t,e,n){return t[e]=n,t};return h=t(),v(l,"prototype",{value:v({},"constructor",l)},!1),v(l,"resolve",function(t){var n=this;return"object"==typeof t&&t instanceof n?t:new n(function(n,r){a(n,r),e(function(){c(n,t)})})}),v(l,"reject",function(t){return new this(function(e,n){a(e,n),n(t)})}),v(l,"all",function(t){var e,n=this;return(e=u(n,t))?e:0===t.length?n.resolve([]):new n(function(e,r){a(e,r);var i=t.length,o=Array(i),u=0;f(n,t,function(t,n){o[t]=n,++u===i&&c(e,o)},r)})}),v(l,"race",function(t){var e,n=this;return(e=u(n,t))?e:new n(function(e,r){a(e,r),f(n,t,function(t,n){c(e,n)},r)})}),l});
