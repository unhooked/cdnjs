/*! Native Promise Only
    v0.0.2-a (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function(e,t,i){"undefined"!=typeof module&&module.exports?module.exports=i():"function"==typeof define&&define.amd?define(i):t[e]=t[e]||i(e,t)}("Promise",this,function(){"use strict";function e(e){return"undefined"!=typeof setImmediate?setImmediate(e):setTimeout(e,0)}function t(e,t){var n;return null===e||"object"!=typeof e&&"function"!=typeof e?!1:t?"then"in e:(n=e.then,i(n)?n:!1)}function i(e){return"function"==typeof e}function n(){if(0!==this.state){var e,i,n,r,s;for(1===this.state&&(s=this.success),2===this.state&&(s=this.failure);(e=s.shift())||e===!1;){r=this.chained.shift();try{if(e===!0)i=this.msg;else{if(e===!1)throw this.msg;i=e(this.msg)}if(i===r.promise)throw new TypeError("Illegal promise chain cycle");(n=t(i))?n.call(i,r.resolve,r.reject):r.resolve(i)}catch(o){r.reject(o)}}}}function r(i){var s,c,h;if(this.def){if(this.triggered)return;this.triggered=!0,c=this.def}else c=this;if(0===c.state){h={def:c,triggered:!1};try{(s=t(i))?s.call(i,r.bind(h),o.bind(h)):(c.msg=i,c.state=1,e(n.bind(c)))}catch(f){o.call(h,f)}}}function s(e){this.triggered||(this.triggered=!0,r.call(this,e))}function o(t){var i;if(this.def){if(this.triggered)return;this.triggered=!0,i=this.def}else i=this;0===i.state&&(i.msg=t,i.state=2,e(n.bind(i)))}function c(e){this.triggered||(this.triggered=!0,o.call(this,e))}function h(t,r){this.success.push(i(t)?t:!0),this.failure.push(i(r)?r:!1);var s=new u(function(e,t){this.chained.push({resolve:e,reject:t})}.bind(this));return this.chained[this.chained.length-1].promise=s,e(n.bind(this)),s}function f(e){return this.promise.then(void 0,e)}function u(e){var t={promise:this,state:0,triggered:!1,success:[],failure:[],chained:[]};this.then=h.bind(t),this["catch"]=f.bind(t);try{e(s.bind(t),c.bind(t))}catch(i){o.call(t,i)}}return u.resolve=function(e){return new u(function(t){t(e)})},u.reject=function(e){return new u(function(t,i){i(e)})},u.all=function(e){if(!Array.isArray(e))throw new TypeError("Promise.all requires an array");return new u(function(i,n){function r(e,t){s[e]=t,o++,o===c&&i(s)}var s,o=0,c=e.length;0===c&&i([]),s=[],e.forEach(function(e,i){t(e,!0)||(e=u.resolve(e)),e.then(r.bind(null,i),n)})})},u.race=function(e){if(!Array.isArray(e))throw new TypeError("Promise.race requires an array");return new u(function(i,n){e.some(function(e){return t(e,!0)?void e.then(i,n):(i(e),!0)})})},u});
