/*! Native Promise Only
    v0.4.0-f (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function(t,e,n){e[t]=e[t]||n(),"undefined"!=typeof module&&module.exports?module.exports=e[t]:"function"==typeof define&&define.amd&&define(function(){return e[t]})}("Promise","undefined"!=typeof global?global:this,function(){"use strict";function t(){function t(t,e){this.fn=t,this.self=e,this.next=void 0}var e,n,r;return{add:function(i,o){r=new t(i,o),n?n.next=r:e=r,n=r,r=void 0},drain:function(){for(;e;)e.fn.call(e.self),e=e.next;l=n=e}}}function e(t,e){g?(g=!1,t.call(e)):(d.add(t,e),l||(l=h(d.drain)))}function n(t){var e,n=typeof t;return null===t||"object"!==n&&"function"!==n||(e=t.then),"function"==typeof e?e:!1}function r(){var t,e,r,i,o=this;if(0===o.state)return g=!1;for(;i=o.chain.shift();){t=1===o.state?i.success:i.failure;try{t===!1?(g=!0,i.reject(o.msg)):(e=t===!0?o.msg:t.call(void 0,o.msg),g=!0,e===i.promise?i.reject(TypeError("Promise-chain cycle")):(r=n(e))?r.call(e,i.resolve,i.reject):i.resolve(e))}catch(f){g=!0,i.reject(f)}}}function i(t){var f,c,u=this;if(u.def){if(u.triggered)return g=!1;u.triggered=!0,u=u.def}if(0!==u.state)return g=!1;c={def:u,triggered:!1};try{(f=n(t))?f.call(t,function(){i.apply(c,arguments)},function(){o.apply(c,arguments)}):(u.msg=t,u.state=1,e(r,u))}catch(a){o.call(c,a)}}function o(t){var n=this;if(n.def){if(n.triggered)return g=!1;n.triggered=!0,n=n.def}return 0!==n.state?g=!1:(n.msg=t,n.state=2,void e(r,n))}function f(t,e){g=!0,t(e)}function c(t,e,n,r){for(var i=0;i<e.length;i++)t.resolve(e[i]).then(function(t){n(i,t)},r)}function u(t,e){return Array.isArray(e)?void 0:t.reject(TypeError("Not an array"))}function a(t,e){if("function"!=typeof t)throw TypeError("Not a function");if("function"!=typeof e)throw TypeError("Not a function")}function s(t){if("function"!=typeof t)throw TypeError("Not a function");var n={promise:this,state:0,triggered:!1,chain:[],msg:void 0};p(this,"then",function(t,i){var o={success:"function"==typeof t?t:!0,failure:"function"==typeof i?i:!1};return o.promise=new s(function(t,e){a(t,e),o.resolve=t,o.reject=e}),n.chain.push(o),e(r,n),o.promise}),p(this,"catch",function(t){return n.promise.then(void 0,t)});try{t.call(void 0,function(t){return n.triggered?void(g=!1):(n.triggered=!0,void i.call(n,t))},function(t){return n.triggered?void(g=!1):(n.triggered=!0,void o.call(n,t))})}catch(f){o.call(n,f)}}var l,d,g=!1,h="undefined"!=typeof setImmediate?function(t){return setImmediate(t)}:setTimeout,p=Object.defineProperty?function(t,e,n,r){return Object.defineProperty(t,e,{value:n,writable:!0,configurable:r!==!1})}:function(t,e,n){return t[e]=n,t};return d=t(),p(s,"prototype",{value:p({},"constructor",s)},!1),p(s,"resolve",function(t){var n=this;return"object"==typeof t&&t instanceof n?t:new n(function(n,r){a(n,r),e(function(){f(n,t)})})}),p(s,"reject",function(t){return new this(function(e,n){a(e,n),n(t)})}),p(s,"all",function(t){var e,n=this;return(e=u(n,t))?e:0===t.length?n.resolve([]):new n(function(e,r){a(e,r);var i=t.length,o=Array(i),u=0;c(n,t,function(t,n){o[t]=n,++u===i&&f(e,o)},r)})}),p(s,"race",function(t){var e,n=this;return(e=u(n,t))?e:new n(function(e,r){a(e,r),c(n,t,function(t,n){f(e,n)},r)})}),s});
