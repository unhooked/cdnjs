/*! Native Promise Only
    v0.1.0-a (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function(e,t,i){"undefined"!=typeof module&&module.exports?module.exports=i():"function"==typeof define&&define.amd?define(i):t[e]=t[e]||i(e,t)}("Promise",this,function(){"use strict";function e(e){g?(g=!1,e()):"undefined"!=typeof setImmediate?setImmediate(e):setTimeout(e,0)}function t(e){var t;return null===e||"object"!=typeof e&&"function"!=typeof e||(t=e.then),"function"==typeof t?t:!1}function i(){if(0===this.state)return g=!1;var e,i,n,r,s;for(1===this.state&&(s=this.success,this.failure.length=0),2===this.state&&(s=this.failure,this.success.length=0);(e=s.shift())||e===!1;){r=this.chained.shift();try{e===!1?(g=!0,r.reject(this.msg)):(i=e===!0?this.msg:e(this.msg),g=!0,i===r.promise?r.reject(TypeError("Illegal promise chain cycle")):(n=t(i))?n.call(i,r.resolve,r.reject):r.resolve(i))}catch(o){g=!0,r.reject(o)}}}function n(r){var o,c,u;if(this.def){if(this.triggered)return g=!1;this.triggered=!0,c=this.def}else c=this;if(0!==c.state)return g=!1;u={def:c,triggered:!1};try{(o=t(r))?o.call(r,n.bind(u),s.bind(u)):(c.msg=r,c.state=1,e(i.bind(c)))}catch(f){s.call(u,f)}}function r(e){return this.triggered?void(g=!1):(this.triggered=!0,void n.call(this,e))}function s(t){var n;if(this.def){if(this.triggered)return g=!1;this.triggered=!0,n=this.def}else n=this;return 0!==n.state?g=!1:(n.msg=t,n.state=2,void e(i.bind(n)))}function o(e){return this.triggered?void(g=!1):(this.triggered=!0,void s.call(this,e))}function c(e,t){this.chained.push({resolve:e,reject:t})}function u(t,n){this.success.push("function"==typeof t?t:!0),this.failure.push("function"==typeof n?n:!1);var r=new h(c.bind(this));return this.chained[this.chained.length-1].promise=r,e(i.bind(this)),r}function f(e){return this.promise.then(void 0,e)}function h(e){if("function"!=typeof e)throw TypeError("Promise requires a function");var t={promise:this,state:0,triggered:!1,success:[],failure:[],chained:[]};this.then=u.bind(t),this["catch"]=f.bind(t);try{e(r.bind(t),o.bind(t))}catch(i){s.call(t,i)}}function a(e,t){g=!0,e(t)}function d(e,t){if(!Array.isArray(t))throw TypeError("Promise."+e+" requires an array")}function l(e,t,i){e.forEach(function(e,n){h.resolve(e).then(t.bind(null,n),i)})}h.resolve=function(t){return"object"==typeof t&&t instanceof h?t:new h(function(i){e(a.bind(null,i,t))})},h.reject=function(e){return new h(function(t,i){i(e)})},h.all=function(e){return d("all",e),new h(function(t,i){function n(e,i){r[e]=i,s++,s===o&&a(t,r)}var r,s=0,o=e.length;0===o?t([]):(r=[],l(e,n,i))})},h.race=function(e){return d("race",e),new h(function(t,i){l(e,function(e,i){a(t,i)},i)})},Object.defineProperty&&Object.defineProperty(h,"prototype",{value:Object.defineProperty({},"constructor",{writable:!0,configurable:!0,value:h})});var g=!1;return h});
