/*! Native Promise Only
    v0.2.1-c (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function(e,t,i){"undefined"!=typeof module&&module.exports?module.exports=i():"function"==typeof define&&define.amd?define(i):t[e]=t[e]||i(e,t)}("Promise",this,function(){"use strict";function e(e){g?(g=!1,e()):p?setImmediate(e):setTimeout(e,0)}function t(e){var t,i=typeof e;return null===e||"object"!==i&&"function"!==i||(t=e.then),"function"==typeof t?t:!1}function i(){var e,i,n,r,s;switch(this.state){case 0:return g=!1;case 1:s=this.success,this.failure.length=0;break;case 2:s=this.failure,this.success.length=0}for(;(e=s.shift())||e===!1;){r=this.chained.shift();try{e===!1?(g=!0,r.reject(this.msg)):(i=e===!0?this.msg:e(this.msg),g=!0,i===r.promise?r.reject(TypeError("Promise-chain cycle")):(n=t(i))?n.call(i,r.resolve,r.reject):r.resolve(i))}catch(c){g=!0,r.reject(c)}}}function n(r){var c,o,u;if(this.def){if(this.triggered)return g=!1;this.triggered=!0,o=this.def}else o=this;if(0!==o.state)return g=!1;u={def:o,triggered:!1};try{(c=t(r))?c.call(r,n.bind(u),s.bind(u)):(o.msg=r,o.state=1,e(i.bind(o)))}catch(f){s.call(u,f)}}function r(e){return this.triggered?void(g=!1):(this.triggered=!0,void n.call(this,e))}function s(t){var n;if(this.def){if(this.triggered)return g=!1;this.triggered=!0,n=this.def}else n=this;return 0!==n.state?g=!1:(n.msg=t,n.state=2,void e(i.bind(n)))}function c(e){return this.triggered?void(g=!1):(this.triggered=!0,void s.call(this,e))}function o(e,t){this.chained.push({resolve:e,reject:t})}function u(e,t){g=!0,e(t)}function f(e){return Array.isArray(e)?void 0:l.reject(TypeError("Expected array argument"))}function h(e,t,i){e.forEach(function(e,n){l.resolve(e).then(t.bind(null,n),i)})}function a(t,n){this.success.push("function"==typeof t?t:!0),this.failure.push("function"==typeof n?n:!1);var r=new l(o.bind(this));return this.chained[this.chained.length-1].promise=r,e(i.bind(this)),r}function d(e){return this.promise.then(void 0,e)}function l(e){if("function"!=typeof e)throw TypeError("Expected function argument");var t={promise:this,state:0,triggered:!1,success:[],failure:[],chained:[]};v(this,"then",a.bind(t)),v(this,"catch",d.bind(t));try{e(r.bind(t),c.bind(t))}catch(i){s.call(t,i)}}var g=!1,p="undefined"!=typeof setImmediate,v=Object.defineProperty?function(e,t,i,n){return Object.defineProperty(e,t,{value:i,writable:!0,configurable:n!==!1})}:function(e,t,i){return e[t]=i,e};return v(l,"prototype",{value:v({},"constructor",l)},!1),v(l,"resolve",function(t){return"object"==typeof t&&t instanceof l?t:new l(function(i){e(u.bind(null,i,t))})}),v(l,"reject",function(e){return new l(function(t,i){i(e)})}),v(l,"all",function(e){var t;return(t=f(e))?t:0===e.length?l.resolve([]):new l(function(t,i){function n(e,i){r[e]=i,s++,s===c&&u(t,r)}var r=[],s=0,c=e.length;h(e,n,i)})}),v(l,"race",function(e){var t;return(t=f(e))?t:new l(function(t,i){h(e,function(e,i){u(t,i)},i)})}),l});
