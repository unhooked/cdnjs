/*! Native Promise Only
    v0.2.1-a (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function(t,e,i){"undefined"!=typeof module&&module.exports?module.exports=i():"function"==typeof define&&define.amd?define(i):e[t]=e[t]||i(t,e)}("Promise",this,function(){"use strict";function t(t){g?(g=!1,t()):"undefined"!=typeof setImmediate?setImmediate(t):setTimeout(t,0)}function e(t){var e;return null===t||"object"!=typeof t&&"function"!=typeof t||(e=t.then),"function"==typeof e?e:!1}function i(){if(0===this.state)return g=!1;var t,i,n,r,s;for(1===this.state&&(s=this.success,this.failure.length=0),2===this.state&&(s=this.failure,this.success.length=0);(t=s.shift())||t===!1;){r=this.chained.shift();try{t===!1?(g=!0,r.reject(this.msg)):(i=t===!0?this.msg:t(this.msg),g=!0,i===r.promise?r.reject(TypeError("Promise-chain cycle")):(n=e(i))?n.call(i,r.resolve,r.reject):r.resolve(i))}catch(o){g=!0,r.reject(o)}}}function n(r){var o,c,u;if(this.def){if(this.triggered)return g=!1;this.triggered=!0,c=this.def}else c=this;if(0!==c.state)return g=!1;u={def:c,triggered:!1};try{(o=e(r))?o.call(r,n.bind(u),s.bind(u)):(c.msg=r,c.state=1,t(i.bind(c)))}catch(f){s.call(u,f)}}function r(t){return this.triggered?void(g=!1):(this.triggered=!0,void n.call(this,t))}function s(e){var n;if(this.def){if(this.triggered)return g=!1;this.triggered=!0,n=this.def}else n=this;return 0!==n.state?g=!1:(n.msg=e,n.state=2,void t(i.bind(n)))}function o(t){return this.triggered?void(g=!1):(this.triggered=!0,void s.call(this,t))}function c(t,e){this.chained.push({resolve:t,reject:e})}function u(t,e){g=!0,t(e)}function f(t){return Array.isArray(t)?void 0:l.reject(TypeError("Expected array argument"))}function h(t,e,i){t.forEach(function(t,n){l.resolve(t).then(e.bind(null,n),i)})}function d(e,n){this.success.push("function"==typeof e?e:!0),this.failure.push("function"==typeof n?n:!1);var r=new l(c.bind(this));return this.chained[this.chained.length-1].promise=r,t(i.bind(this)),r}function a(t){return this.promise.then(void 0,t)}function l(t){if("function"!=typeof t)throw TypeError("Expected function argument");var e={promise:this,state:0,triggered:!1,success:[],failure:[],chained:[]};p(this,"then",d.bind(e)),p(this,"catch",a.bind(e));try{t(r.bind(e),o.bind(e))}catch(i){s.call(e,i)}}var g=!1,p=Object.defineProperty?function(t,e,i,n){return Object.defineProperty(t,e,{value:i,writable:!0,configurable:n!==!1})}:function(t,e,i){return t[e]=i,t};return p(l,"prototype",{value:p({},"constructor",l)},!1),p(l,"resolve",function(e){return"object"==typeof e&&e instanceof l?e:new l(function(i){t(u.bind(null,i,e))})}),p(l,"reject",function(t){return new l(function(e,i){i(t)})}),p(l,"all",function(t){var e;return(e=f(t))?e:0===t.length?l.resolve([]):new l(function(e,i){function n(t,i){r[t]=i,s++,s===o&&u(e,r)}var r=[],s=0,o=t.length;h(t,n,i)})}),p(l,"race",function(t){var e;return(e=f(t))?e:new l(function(e,i){h(t,function(t,i){u(e,i)},i)})}),l});
