/*! Native Promise Only
    v0.0.3-a (c) Kyle Simpson
    MIT License: http://getify.mit-license.org
*/
!function(e,t,i){"undefined"!=typeof module&&module.exports?module.exports=i():"function"==typeof define&&define.amd?define(i):t[e]=t[e]||i(e,t)}("Promise",this,function(){"use strict";function e(e){return"undefined"!=typeof setImmediate?setImmediate(e):setTimeout(e,0)}function t(e,t){var n;return null===e||"object"!=typeof e&&"function"!=typeof e?!1:t?"then"in e:(n=e.then,i(n)?n:!1)}function i(e){return"function"==typeof e}function n(){if(0!==this.state){var e,i,n,r,s;for(1===this.state&&(s=this.success),2===this.state&&(s=this.failure);(e=s.shift())||e===!1;){r=this.chained.shift();try{e===!0?i=this.msg:e===!1?r.reject(this.msg):i=e(this.msg),i===r.promise&&r.reject(new TypeError("Illegal promise chain cycle")),(n=t(i))?n.call(i,r.resolve,r.reject):r.resolve(i)}catch(c){r.reject(c)}}}}function r(i){var s,o,h;if(this.def){if(this.triggered)return;this.triggered=!0,o=this.def}else o=this;if(0===o.state){h={def:o,triggered:!1};try{(s=t(i))?s.call(i,r.bind(h),c.bind(h)):(o.msg=i,o.state=1,e(n.bind(o)))}catch(u){c.call(h,u)}}}function s(e){this.triggered||(this.triggered=!0,r.call(this,e))}function c(t){var i;if(this.def){if(this.triggered)return;this.triggered=!0,i=this.def}else i=this;0===i.state&&(i.msg=t,i.state=2,e(n.bind(i)))}function o(e){this.triggered||(this.triggered=!0,c.call(this,e))}function h(t,r){this.success.push(i(t)?t:!0),this.failure.push(i(r)?r:!1);var s=new f(function(e,t){this.chained.push({resolve:e,reject:t})}.bind(this));return this.chained[this.chained.length-1].promise=s,e(n.bind(this)),s}function u(e){return this.promise.then(void 0,e)}function f(e){var t={promise:this,state:0,triggered:!1,success:[],failure:[],chained:[]};this.then=h.bind(t),this["catch"]=u.bind(t);try{e(s.bind(t),o.bind(t))}catch(i){c.call(t,i)}}return f.resolve=function(e){return new f(function(t){t(e)})},f.reject=function(e){return new f(function(t,i){i(e)})},f.all=function(e){if(!Array.isArray(e))throw new TypeError("Promise.all requires an array");return new f(function(i,n){function r(e,t){s[e]=t,c++,c===o&&i(s)}var s,c=0,o=e.length;0===o&&i([]),s=[],e.forEach(function(e,i){t(e,!0)||(e=f.resolve(e)),e.then(r.bind(null,i),n)})})},f.race=function(e){if(!Array.isArray(e))throw new TypeError("Promise.race requires an array");return new f(function(i,n){e.some(function(e){return t(e,!0)?void e.then(i,n):(i(e),!0)})})},f});
