/*! 
 * Riloadr.js 1.3.0 (c) 2012 Tubal Martin - MIT license
 */
!function(e){typeof define=="function"&&define.amd?define(e):window.Riloadr=e()}(function(){"use strict";function et(e){function z(){ft(H,c,M),ft(H,h,D),V&&(Z=H[N],ft(H,_,j))}function J(){lt(H,c,M),lt(H,h,D),V&&lt(H,_,j)}function K(e,t){e[v]=0,e[y]=n,e[p]=Q,e[d]=et,e.src=rt(e,u,R),F.splice(t,1)}function Q(){var t=this;t[p]=t[d]=i,t[b]=t[b].replace(w,"$1$2"),p in e&&e[p][o](t),ht()}function et(){var n=this;d in e&&e[d][o](n),n[v]<k?(n[v]++,n.src=rt(n,u,n[y]?U:R,t)):y in q&&!n[y]?(n[v]=0,n[y]=t,n.src=rt(n,u,U)):ht()}function ht(){I--,I==0&&S in e&&e[S]()}var s=this,u=e.base||f,a=e.breakpoints||at('"breakpoints" not defined.'),m=e.name||"responsive",w=new RegExp("(^|\\s)"+m+"(\\s|$)"),E=e.defer&&e.defer.toLowerCase()||n,T=e.foldDistance||100,C=e.ignoreLowBandwidth||n,k=e[v]||0,L=e.root||i,A=E==="belowfold"&&X&&!G,M=A&&st(function(){s[x]()},r),D=A&&ot(function(){s[x]()},r),j=A&&ot(function(){H[N]!==Z&&(Z=H[N],s[x]())},r),F=[],I=0,q,R,U;s[x]=function(e){ut(function(n,r,s){if(!F[l]||e===t){A&&z(),n=W&&L[O]("img."+m)||L.getElementsByTagName("img"),s=0;while(r=n[s])r&&!r[g]&&(W||r[b].indexOf(m)>=0)&&(r[g]=t,F.push(r),I++),s++}if(F[l]){s=0;while(r=F[s])r&&(!A||A&&!it(r,T))&&(K(r,s),s--),s++}A&&!F[l]&&J(),n=r=i})},Y(function(){P=B.body,L=B.getElementById(L)||P,$=$||nt(),q=tt(a,$,C),R=q.name,U=q[y],!E||A?s[x]():ct(s[x])})}function tt(e,t,n){var r=t,i=0,s={},o,u,a,f;while(o=e[i]){u=o.minWidth,a=o.maxWidth,f=o.minDevicePixelRatio;if(t>0){if(u&&a&&t>=u&&t<=a||u&&!a&&t>=u||a&&!u&&t<=a)if(!f||f&&K>=f&&(n||!n&&!Q))s=o}else if(r<=0||u<r||a<r)r=u||a||r,s=o;i++}return s}function nt(){var e=Math,t=[j.clientWidth,j.offsetWidth,P.clientWidth],n=e.ceil(J/K),r=t[l],i=0,s;for(;i<r;i++)isNaN(t[i])&&(t.splice(i,1),i--);return t[l]&&(s=e.max[u](e,t),isNaN(n)||(s=e.min(n,s))),s||n||0}function rt(e,t,n,r){var i=(e.getAttribute("data-base")||t)+(e.getAttribute("data-src")||f);return r&&(i+=(U.test(i)?"&":"?")+"riloadrts="+(new Date).getTime()),i.replace(z,n)}function it(e,t){var n=j[E]||P[E]||0,r=B.compatMode==="CSS1Compat"&&j[k]||P&&P[k]||j[k];return r<=e[D]().top-n-t}function Q(){var e=H.navigator,t=e.connection||e.mozConnection||e.webkitConnection||e.oConnection||e.msConnection||{},n=t.type||"unknown",r=+t.bandwidth||Infinity;return r>0&&r<.1||/^[23]g|3|4$/.test(n+f)}function st(e,t){function f(){a=new Date,o=i,e[u](s,n)}var n,r,s,o,a=0;return function(){var i=new Date,l=t-(i-a);return n=arguments,s=this,l<=0?(a=i,r=e[u](s,n)):o||(o=setTimeout(f,l)),r}}function ot(e,t,n){function f(){a=i,n||e[u](o,r)}var r,s,o,a;return function(){var i=n&&!a;return r=arguments,o=this,clearTimeout(a),a=setTimeout(f,t),i&&(s=e[u](o,r)),s}}function ut(e){var t=Array[w].slice[o](arguments,1);setTimeout(function(){return e[u](i,t)},1)}function at(e){throw new Error("Riloadr: "+e)}function ft(e,t,r){e[q](I+t,r,n)}function lt(e,t,r){e[R](I+t,r,n)}function ct(e){if(B[T]===m)e();else{var t=function(){lt(H,s,t),e()};ft(H,s,t)}}var e="on",t=!0,n=!1,r=250,i=null,s="load",o="call",u="apply",a="error",f="",l="length",c="scroll",h="resize",p=e+s,d=e+a,v="retries",m="complete",g="riloaded",y="fallback",b="className",w="prototype",E="clientTop",S=e+m,x="loadImages",T="readyState",N="orientation",C="attachEvent",k="clientHeight",L="EventListener",A="readystatechange",O="querySelectorAll",M="add"+L,_=N+"change",D="getBoundingClientRect",P,H=window,B=H.document,j=B.documentElement,F=M in B,I=F?f:e,q=F?M:C,R=F?"remove"+L:"detachEvent",U=/\?/,z=/{breakpoint-name}/gi,W=O in B,X=D in j,V=N in H&&e+_ in H,$,J=H.screen.width,K=H.devicePixelRatio||1,Q=Q(),G=Object[w].toString[o](H.operamini)==="[object OperaMini]",Y,Z;return j[b]=j[b].replace(/(^|\s)no-js(\s|$)/,"$1$2"),et.version="1.3.0",et[w].riload=function(){this[x](t)},Y=function(){function f(e){if(!u){if(!B.body)return ut(f);u=t;while(e=o.shift())ut(e)}}function l(){if(!u){try{j.doScroll("left")}catch(e){return ut(l)}f()}}var e="DOMContentLoaded",r=n,o=[],u=n,a;if(B[T]===m)f();else{if(B[M])a=function(){lt(B,e,a),f()},ft(B,e,a);else if(B[C]){a=function(){B[T]===m&&(lt(B,A,a),f())},ft(B,A,a);try{r=H.frameElement==i}catch(c){}j.doScroll&&r&&l()}ft(H,s,f)}return function(e){u?ut(e):o.push(e)}}(),et});