/*!***************************************************
 * jmHighlight
 * Version 3.1.3
 * Copyright (c) 2014–2016, Julian Motz
 * For the full copyright and license information, 
 * please view the LICENSE file that was distributed 
 * with this source code.
 *****************************************************/
!function(a,b){"use strict";"function"==typeof define&&define.amd?define(["jquery"],function(a,c){return b(a,c)}):"object"==typeof exports?b(require("jquery"),a):b(a.jQuery,a)}(this,function(a,b){"use strict";function c(a,c,e){return this.options=d.extend({},{debug:!1,log:b.console,element:"span",className:"highlight",filter:[],separateWordSearch:!1,diacritics:!0,synonyms:{}},e),this.keyword="string"==typeof c?this.escapeStr(c):"",this.$elements=d(),a instanceof d&&a.length>0&&!a.is(d("html"))&&(this.$elements=a.add(a.find("*")),this.filterElements()),this}var d=a;c.prototype.diacritics=["aÀÁÂÃÄÅàáâãäåĀāąĄ","cÇçćĆčČ","dđĐďĎ","eÈÉÊËèéêëěĚĒēęĘ","iÌÍÎÏìíîïĪī","lłŁ","nÑñňŇńŃ","oÒÓÔÕÕÖØòóôõöøŌō","rřŘ","sŠšśŚ","tťŤ","uÙÚÛÜùúûüůŮŪū","yŸÿýÝ","zŽžżŻźŹ"],c.prototype.escapeStr=function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},c.prototype.log=function(a,b){"string"!=typeof b&&(b="debug"),"string"==typeof a&&this.options.debug&&this.options.log[b]("jmHighlight: "+a),"object"==typeof a&&this.options.debug&&this.options.log[b]("jmHighlight: ",a)},c.prototype.filterElements=function(){var a=this.options.filter;"object"==typeof a&&"[object Array]"===Object.prototype.toString.call(a)&&this.$elements instanceof d!=!1&&(this.$elements=this.$elements.filter(function(){for(var b=0,c=a.length;c>b;b++)if(d(this).is(a[b]))return!1;return!0}).filter(":not(script):not(style)"))},c.prototype.getKeywordRegexp=function(a){var b="string"!=typeof a?this.keyword:a;if("string"!=typeof b||""===b)return b;var c=b;return"object"!=typeof this.options.synonyms||d.isEmptyObject(this.options.synonyms)||(c=this.getSynonymsRegex(c)),"boolean"==typeof this.options.diacritics&&this.options.diacritics&&(c=this.getDiacriticsRegex(c)),c},c.prototype.getSynonymsRegex=function(a){var b=a;if("string"!=typeof b)return b;var c=this;return d.each(this.options.synonyms,function(a,d){var e=c.escapeStr(a),f=c.escapeStr(d);b=b.replace(new RegExp("("+e+"|"+f+")","gmi"),"("+e+"|"+f+")")}),b},c.prototype.getDiacriticsRegex=function(a){var b=a;if("string"!=typeof b)return b;for(var c=b.split(""),d=[],e=0,f=c.length;f>e;e++)for(var g=c[e],h=0,i=this.diacritics.length;i>h;h++){var j=this.diacritics[h];if(-1!==j.indexOf(g)){if(d.indexOf(j)>-1)continue;b=b.replace(new RegExp("["+j+"]","gmi"),"["+j+"]"),d.push(j)}}return b},c.prototype.highlight=function(a){var b="string"!=typeof a?this.keyword:a;if(""===b)return!0;if(0===this.$elements.length)return this.log("No search context provided","warn"),!1;var c=this.options.separateWordSearch,e=b.split(" ");if("boolean"==typeof c&&c&&e.length>1){for(var f=0,g=e.length;g>f;f++)if(!this.highlight(e[f]))return!1;return!0}this.$elements=this.$elements.filter("*:not([data-jmHighlight])");var h=this.getKeywordRegexp(b),i=new RegExp(h,"gmi"),j=this.options.element,k=this.options.className;return this.log("Highlighting keyword '"+b+"' with regex '"+h+"' in elements:"),this.log(this.$elements),this.$elements.contents().filter(function(){return 3==this.nodeType&&""!==this.textContent.trim()}).each(function(){for(var a,b,c=this;null!==(a=i.exec(c.textContent));)b=c.splitText(a.index),c=b.splitText(a[0].length),i.lastIndex=0,d(b).replaceWith(d("<"+j+" />",{"class":k,"data-jmHighlight":!0,text:a[0]}))}),!0},c.prototype.removeHighlight=function(){if(0===this.$elements.length)return this.log("No search context provided","warn"),!1;"string"==typeof this.keyword&&""!==this.keyword?this.log("Removing highlighting with keyword: '"+this.keyword+"'"):this.log("Removing highlighting");var a=new RegExp(this.getKeywordRegexp(),"mi"),b=this.options.element+"[data-jmHighlight]."+this.options.className,c=this,e=this.$elements.filter(b);return this.log(b),this.log(e),e.each(function(){var b=d(this);return a.test(b.text())?void c.appendTextNodes(b,e):!0}),!0},c.prototype.appendTextNodes=function(a,b){if(a instanceof d==!1||0===a.length)return!1;var c=a.first()[0],e=c.previousSibling,f=c.nextSibling,g=d(e),h=d(f),i=!1;return g.length>0&&(3===e.nodeType?(e.nodeValue=e.nodeValue+a.text(),a.remove()):b instanceof d&&b.length>0&&b.is(g)?(g.replaceWith(a.text()+g.text()),a.remove()):a.replaceWith(a.text()),i=!0),h.length>0&&(3===f.nodeType?0===g.length?(f.nodeValue=a.text()+f.nodeValue,a.remove()):(f.nodeValue=g.text()+f.nodeValue,g.remove()):b instanceof d&&b.length>0&&b.is(h)?0===g.length?(h.replaceWith(h.text()+a.text()),a.remove()):(h.replaceWith(g.text()+h.text()),g.remove()):0===g.length&&a.replaceWith(a.text()),i=!0),i===!1&&a.replaceWith(a.text()),!0},d.fn.jmHighlight=function(a,b){var e=new c(d(this),a,b);return e.highlight()},d.fn.jmRemoveHighlight=function(a,b){var e=new c(d(this),b,a);return e.removeHighlight()}});