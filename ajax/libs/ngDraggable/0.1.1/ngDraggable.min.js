angular.module("ngDraggable",[]).service("ngDraggable",[function(){var t=this;t.inputEvent=function(t){return angular.isDefined(t.touches)?t.touches[0]:t}}]).directive("ngDrag",["$rootScope","$parse","$document","$window","ngDraggable",function(t,n,e,a,o){return{restrict:"A",link:function(r,i,c){r.value=c.ngDrag;var l,u,s,g,f,d,m,v,p=!1,$="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,D="touchstart mousedown",h="touchmove mousemove",b="touchend mouseup",w=r.$id,x=null,y=null,C=!1,k=null,S=n(c.ngDragSuccess)||null,T=angular.isDefined(c.allowTransform)?r.$eval(c.allowTransform):!0;console.log("40","scope","link",angular.isDefined(c.allowTransform),T);var E=function(){i.attr("draggable","false");var t=i.find("[ng-drag-handle]");t.length&&(v=t),X(!0)},X=function(t){t&&(r.$on("$destroy",Y),r.$watch(c.ngDrag,A),r.$watch(c.ngCenterAnchor,B),r.$watch(c.ngDragData,z),v?v.on(D,P):i.on(D,P),$||"img"!=i[0].nodeName.toLowerCase()||i.on("mousedown",function(){return!1}))},Y=function(t){X(!1)},z=function(t,n){x=t},A=function(t,n){C=t},B=function(t,n){angular.isDefined(t)&&(p=t||"true")},H=function(t){return angular.isDefined(angular.element(t.target).attr("ng-click"))||angular.isDefined(angular.element(t.target).attr("ng-dblclick"))||angular.isDefined(angular.element(t.target).attr("ng-cancel-drag"))},P=function(t){C&&(H(t)||($?(W(),k=setTimeout(function(){W(),L(t)},100),e.on(h,W),e.on(b,W)):L(t)))},W=function(){clearTimeout(k),e.off(h,W),e.off(b,W)},L=function(n){C&&(n.preventDefault(),i.addClass("dragging"),l=i[0].getBoundingClientRect(),y=T?l:{left:document.body.scrollLeft,top:document.body.scrollTop},i.centerX=i[0].offsetWidth/2,i.centerY=i[0].offsetHeight/2,u=o.inputEvent(n).pageX,s=o.inputEvent(n).pageY,d=u-l.left,m=s-l.top,p?(g=u-i.centerX-a.pageXOffset,f=s-i.centerY-a.pageYOffset):(g=u-d-a.pageXOffset,f=s-m-a.pageYOffset),e.on(h,O),e.on(b,_),t.$broadcast("draggable:start",{x:u,y:s,tx:g,ty:f,event:n,element:i,data:x}))},O=function(n){C&&(n.preventDefault(),u=o.inputEvent(n).pageX,s=o.inputEvent(n).pageY,p?(g=u-i.centerX-y.left,f=s-i.centerY-y.top):(g=u-d-y.left,f=s-m-y.top),R(g,f),t.$broadcast("draggable:move",{x:u,y:s,tx:g,ty:f,event:n,element:i,data:x,uid:w}))},_=function(n){C&&(n.preventDefault(),t.$broadcast("draggable:end",{x:u,y:s,tx:g,ty:f,event:n,element:i,data:x,callback:I,uid:w}),i.removeClass("dragging"),i.parent().find(".drag-enter").removeClass("drag-enter"),M(),e.off(h,O),e.off(b,_))},I=function(t){S&&r.$apply(function(){S(r,{$data:x,$event:t})})},M=function(){T?i.css({transform:"","z-index":"","-webkit-transform":"","-ms-transform":""}):i.css({position:"",top:"",left:""})},R=function(t,n){T?i.css({transform:"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+t+", "+n+", 0, 1)","z-index":99999,"-webkit-transform":"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+t+", "+n+", 0, 1)","-ms-transform":"matrix(1, 0, 0, 1, "+t+", "+n+")"}):i.css({left:t+"px",top:n+"px",position:"fixed"})};E()}}}]).directive("ngDrop",["$parse","$timeout","$window","ngDraggable",function(t,n,e,a){return{restrict:"A",link:function(e,a,o){e.value=o.ngDrop,e.isTouching=!1;var r=null,i=e.$id,c=!1,l=t(o.ngDropSuccess),u=t(o.ngDragStart),s=t(o.ngDragStop),g=t(o.ngDragMove),f=function(){d(!0)},d=function(t){t&&(o.$observe("ngDrop",v),e.$on("$destroy",m),e.$on("draggable:start",p),e.$on("draggable:move",$),e.$on("draggable:end",D))},m=function(t){d(!1)},v=function(t,n){c=e.$eval(t)},p=function(t,a){c&&(h(a.x,a.y,a.element),n(function(){u(e,{$data:a.data,$event:a})}))},$=function(t,a){c&&(h(a.x,a.y,a.element),n(function(){g(e,{$data:a.data,$event:a})}))},D=function(t,a){return console.log("266","onDragEnd","onDragEnd",i,a.uid),c&&i!==a.uid?(h(a.x,a.y,a.element)&&(a.callback&&a.callback(a),n(function(){l(e,{$data:a.data,$event:a,$target:e.$eval(e.value)})})),n(function(){s(e,{$data:a.data,$event:a})}),void b(!1,a.element)):void b(!1,a.element)},h=function(t,n,o){var i=w(t,n);return e.isTouching=i,i&&(r=a),b(i,o),i},b=function(t,n){t?(a.addClass("drag-enter"),n.addClass("drag-over")):r==a&&(r=null,a.removeClass("drag-enter"),n.removeClass("drag-over"))},w=function(t,n){var e=a[0].getBoundingClientRect();return e.right=e.left+a[0].offsetWidth,e.bottom=e.top+a[0].offsetHeight,t>=e.left&&t<=e.right&&n<=e.bottom&&n>=e.top};f()}}}]).directive("ngDragClone",["$parse","$timeout","ngDraggable",function(t,n,e){return{restrict:"A",link:function(t,n,e){var a,o=!0,r=null;t.clonedData={};var i=function(){a=n.find("img"),n.attr("draggable","false"),a.attr("draggable","false"),f(),c(!0)},c=function(n){n&&(t.$on("draggable:start",u),t.$on("draggable:move",s),t.$on("draggable:end",g),l())},l=function(){a.off("mousedown touchstart touchmove touchend touchcancel",m),a.on("mousedown touchstart touchmove touchend touchcancel",m)},u=function(e,a,i){o=!0,angular.isDefined(a.data.allowClone)&&(o=a.data.allowClone),o&&(t.$apply(function(){t.clonedData=a.data}),n.css("width",a.element[0].offsetWidth),n.css("height",a.element[0].offsetHeight),d(a.tx,a.ty)),r=n[0].getBoundingClientRect()},s=function(t,n){o&&(_tx=n.tx+r.left,_ty=n.ty+r.top,d(_tx,_ty))},g=function(t,n){o&&f()},f=function(){n.css({left:0,top:0,position:"fixed","z-index":-1,visibility:"hidden"})},d=function(t,e){n.css({transform:"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+t+", "+e+", 0, 1)","z-index":99999,visibility:"visible","-webkit-transform":"matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+t+", "+e+", 0, 1)","-ms-transform":"matrix(1, 0, 0, 1, "+t+", "+e+")"})},m=function(t){var n=t;return n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.cancelBubble=!0,n.returnValue=!1,!1};i()}}}]).directive("ngPreventDrag",["$parse","$timeout",function(t,n){return{restrict:"A",link:function(t,n,e){var a=function(){n.attr("draggable","false"),o(!0)},o=function(t){t&&n.on("mousedown touchstart touchmove touchend touchcancel",r)},r=function(t){var n=t.originalEvent;return n.preventDefault&&n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.cancelBubble=!0,n.returnValue=!1,!1};a()}}}]).directive("ngCancelDrag",[function(){return{restrict:"A",link:function(t,n,e){n.find("*").attr("ng-cancel-drag","ng-cancel-drag")}}}]).directive("ngDragScroll",["$window","$interval","$timeout","$document",function(t,n,e,a){return{restrict:"A",link:function(o,r,i){var c=null,l=null,u={verticalScroll:i.verticalScroll||!0,horizontalScroll:i.horizontalScroll||!0,activationDistance:i.activationDistance||75,scrollDistance:i.scrollDistance||50,scrollInterval:i.scrollInterval||250},s=function(){c=n(function(){if(l){var n=Math.max(document.documentElement.clientWidth,window.innerWidth||0),o=Math.max(document.documentElement.clientHeight,window.innerHeight||0),i=0,c=0;if(u.horizontalScroll&&(l.clientX<u.activationDistance?i=-u.scrollDistance:l.clientX>n-u.activationDistance&&(i=u.scrollDistance)),u.verticalScroll&&(l.clientY<u.activationDistance?c=-u.scrollDistance:l.clientY>o-u.activationDistance&&(c=u.scrollDistance)),0!==i||0!==c){var s=$(document).scrollLeft(),g=$(document).scrollTop(),f=r.css("transform");r.css("transform","initial"),t.scrollBy(i,c);var d=$(document).scrollLeft()-s,m=$(document).scrollTop()-g;r.css("transform",f),e(function(){l.pageX+=d,l.pageY+=m,a.trigger(l)})}}},u.scrollInterval)},g=function(){n.cancel(c),c=null};o.$on("draggable:start",function(t,n){n.element[0]===r[0]&&(c||s())}),o.$on("draggable:end",function(t,n){n.element[0]===r[0]&&c&&g()}),o.$on("draggable:move",function(t,n){n.element[0]===r[0]&&(l=n.event)})}}}]);
//# sourceMappingURL=ngDraggable.min.js.map