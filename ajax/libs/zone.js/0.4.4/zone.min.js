!function(e){"use strict";function t(e,n){var r=arguments.length?Object.create(e):this;return r.parent=e,Object.keys(n||{}).forEach(function(t){var o=t.substr(1);"$"===t[0]?r[o]=n[t](e[o]||function(){}):"+"===t[0]?e[o]?r[o]=function(){var r=e[o].apply(this,arguments);return n[t].apply(this,arguments),r}:r[o]=n[t]:"-"===t[0]?e[o]?r[o]=function(){return n[t].apply(this,arguments),e[o].apply(this,arguments)}:r[o]=n[t]:r[t]="object"==typeof n[t]?JSON.parse(JSON.stringify(n[t])):n[t]}),r.$id=++t.nextId,r}var n=null;t.prototype={constructor:t,fork:function(e){return this.onZoneCreated(),new t(this,e)},bind:function(e,t){t||this.enqueueTask(e);var n=this.fork();return function(){return n.run(e,this,arguments)}},bindOnce:function(e){var t=this;return this.bind(function(){var n=e.apply(this,arguments);return t.dequeueTask(e),n})},run:function(t,r,o){o=o||[];var i,a=n;e.zone=n=this;try{this.beforeTask(),i=t.apply(r,o)}catch(c){if(!n.onError)throw c;n.onError(c)}finally{this.afterTask(),e.zone=n=a}return i},onError:null,beforeTask:function(){},onZoneCreated:function(){},afterTask:function(){},enqueueTask:function(){},dequeueTask:function(){}},t.patchSetClearFn=function(e,r){r.map(function(e){return e[0].toUpperCase()+e.substr(1)}).forEach(function(r){var o="set"+r,i=e[o];if(i){var a="clear"+r,c={},u="setInterval"===o?t.bindArguments:t.bindArgumentsOnce;n[o]=function(t){var n,r=t;arguments[0]=function(){return delete c[n],r.apply(this,arguments)};var o=u(arguments);return n=i.apply(e,o),c[n]=!0,n},e[o]=function(){return n[o].apply(this,arguments)};var p=e[a];n[a]=function(e){return c[e]&&(delete c[e],n.dequeueTask()),p.apply(this,arguments)},e[a]=function(){return n[a].apply(this,arguments)}}})},t.nextId=1,t.patchSetFn=function(e,r){r.forEach(function(r){var o=e[r];o&&(n[r]=function(n){var r=n;arguments[0]=function(){return r.apply(this,arguments)};var i=t.bindArgumentsOnce(arguments);return o.apply(e,i)},e[r]=function(){return n[r].apply(this,arguments)})})},t.patchPrototype=function(e,n){n.forEach(function(n){var r=e[n];r&&(e[n]=function(){return r.apply(this,t.bindArguments(arguments))})})},t.bindArguments=function(e){for(var t=e.length-1;t>=0;t--)"function"==typeof e[t]&&(e[t]=n.bind(e[t]));return e},t.bindArgumentsOnce=function(e){for(var t=e.length-1;t>=0;t--)"function"==typeof e[t]&&(e[t]=n.bindOnce(e[t]));return e},t.bindPromiseFn=function(){function e(n){var r=n.then;n.then=function(){var o=t.bindArguments(arguments),i=r.apply(n,o);return e(i)};var o=n["catch"];return n["catch"]=function(){var r=t.bindArguments(arguments),i=o.apply(n,r);return e(i)},n}return window.Promise?function(e){return function(){var t=e.apply(this,arguments);return t instanceof Promise?t:new Promise(function(e,n){t.then(e,n)})}}:function(t){return function(){return e(t.apply(this,arguments))}}}(),t.patchableFn=function(e,t){t.forEach(function(t){var r=e[t];n[t]=function(){return r.apply(e,arguments)},e[t]=function(){return n[t].apply(this,arguments)}})},t.patchProperty=function(e,t){var n=Object.getOwnPropertyDescriptor(e,t)||{enumerable:!0,configurable:!0};delete n.writable,delete n.value;var r=t.substr(2),o="_"+t;n.set=function(e){this[o]&&this.removeEventListener(r,this[o]),"function"==typeof e?(this[o]=e,this.addEventListener(r,e,!1)):this[o]=null},n.get=function(){return this[o]},Object.defineProperty(e,t,n)},t.patchProperties=function(e,n){(n||function(){var t=[];for(var n in e)t.push(n);return t}().filter(function(e){return"on"===e.substr(0,2)})).forEach(function(n){t.patchProperty(e,n)})},t.patchEventTargetMethods=function(e){var t=e.addEventListener;e.addEventListener=function(e,r){return r._bound=r._bound||{},arguments[1]=r._bound[e]=n.bind(r),t.apply(this,arguments)};var r=e.removeEventListener;e.removeEventListener=function(e,t){if(arguments[1]._bound&&arguments[1]._bound[e]){var o=arguments[1]._bound;arguments[1]=o[e],delete o[e]}var i=r.apply(this,arguments);return n.dequeueTask(t),i}},t.patch=function(){t.patchSetClearFn(window,["timeout","interval","immediate"]),t.patchSetFn(window,["requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame"]),t.patchableFn(window,["alert","prompt"]),window.EventTarget?t.patchEventTargetMethods(window.EventTarget.prototype):["ApplicationCache","EventSource","FileReader","InputMethodContext","MediaController","MessagePort","Node","Performance","SVGElementInstance","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebKitNamedFlow","Window","Worker","WorkerGlobalScope","XMLHttpRequestEventTarget","XMLHttpRequestUpload"].filter(function(e){return window[e]}).map(function(e){return window[e].prototype}).forEach(t.patchEventTargetMethods),t.canPatchViaPropertyDescriptor()?(t.patchProperties(HTMLElement.prototype,t.onEventNames),t.patchProperties(XMLHttpRequest.prototype),t.patchProperties(WebSocket.prototype)):(t.patchViaCapturingAllTheEvents(),t.patchClass("XMLHttpRequest"),t.patchWebSocket()),window.Promise&&t.patchPrototype(Promise.prototype,["then","catch"]),t.patchMutationObserverClass("MutationObserver"),t.patchMutationObserverClass("WebKitMutationObserver"),t.patchDefineProperty(),t.patchRegisterElement()},t.canPatchViaPropertyDescriptor=function(){if(!Object.getOwnPropertyDescriptor(HTMLElement.prototype,"onclick")&&"undefined"!=typeof Element){var e=Object.getOwnPropertyDescriptor(Element.prototype,"onclick");if(e&&!e.configurable)return!1}Object.defineProperty(HTMLElement.prototype,"onclick",{get:function(){return!0}});var t=document.createElement("div"),n=!!t.onclick;return Object.defineProperty(HTMLElement.prototype,"onclick",{}),n},t.patchViaCapturingAllTheEvents=function(){t.eventNames.forEach(function(e){var t="on"+e;document.addEventListener(e,function(e){for(var r,o=e.target;o;)o[t]&&!o[t]._unbound&&(r=n.bind(o[t]),r._unbound=o[t],o[t]=r),o=o.parentElement},!0)})},t.patchWebSocket=function(){var e=window.WebSocket;t.patchEventTargetMethods(e.prototype),window.WebSocket=function(n,r){var o,i=arguments.length>1?new e(n,r):new e(n),a=Object.getOwnPropertyDescriptor(i,"onmessage");return a&&a.configurable===!1?(o=Object.create(i),["addEventListener","removeEventListener","send","close"].forEach(function(e){o[e]=function(){return i[e].apply(i,arguments)}})):o=i,t.patchProperties(o,["onclose","onerror","onmessage","onopen"]),o}},t.patchClass=function(e){var r=window[e];if(r){window[e]=function(){var e=t.bindArguments(arguments);switch(e.length){case 0:this._o=new r;break;case 1:this._o=new r(e[0]);break;case 2:this._o=new r(e[0],e[1]);break;case 3:this._o=new r(e[0],e[1],e[2]);break;case 4:this._o=new r(e[0],e[1],e[2],e[3]);break;default:throw new Error("what are you even doing?")}};var o,i=new r("MutationObserver"===e.substr(-16)?function(){}:void 0);for(o in i)!function(t){"function"==typeof i[t]?window[e].prototype[t]=function(){return this._o[t].apply(this._o,arguments)}:Object.defineProperty(window[e].prototype,t,{set:function(e){"function"==typeof e?this._o[t]=n.bind(e):this._o[t]=e},get:function(){return this._o[t]}})}(o)}},t.patchMutationObserverClass=function(e){var t=window[e];if(t){window[e]=function(e){this._o=new t(n.bind(e,!0))};var r=new t(function(){});window[e].prototype.disconnect=function(){var e=this._o.disconnect.apply(this._o,arguments);return this._active&&n.dequeueTask(),this._active=!1,e},window[e].prototype.observe=function(){return this._active||n.enqueueTask(),this._active=!0,this._o.observe.apply(this._o,arguments)};var o;for(o in r)!function(t){void 0===typeof window[e].prototype&&("function"==typeof r[t]?window[e].prototype[t]=function(){return this._o[t].apply(this._o,arguments)}:Object.defineProperty(window[e].prototype,t,{set:function(e){"function"==typeof e?this._o[t]=n.bind(e):this._o[t]=e},get:function(){return this._o[t]}}))}(o)}},t.patchDefineProperty=function(){function e(e,t){return e&&e.__unconfigurables&&e.__unconfigurables[t]}function n(e,t,n){return n.configurable=!0,n.configurable||(e.__unconfigurables||r(e,"__unconfigurables",{writable:!0,value:{}}),e.__unconfigurables[t]=!0),n}var r=Object.defineProperty,o=Object.getOwnPropertyDescriptor,i=Object.create;Object.defineProperty=function(t,o,i){if(e(t,o))throw new TypeError("Cannot assign to read only property '"+o+"' of "+t);return"prototype"!==o&&(i=n(t,o,i)),r(t,o,i)},Object.defineProperties=function(e,t){return Object.keys(t).forEach(function(n){Object.defineProperty(e,n,t[n])}),e},Object.create=function(e,t){return"object"==typeof t&&Object.keys(t).forEach(function(r){t[r]=n(e,r,t[r])}),i(e,t)},Object.getOwnPropertyDescriptor=function(t,n){var r=o(t,n);return e(t,n)&&(r.configurable=!1),r},t._redefineProperty=function(e,t,o){return o=n(e,t,o),r(e,t,o)}},t.patchRegisterElement=function(){if("registerElement"in document){var e=document.registerElement,r=["createdCallback","attachedCallback","detachedCallback","attributeChangedCallback"];document.registerElement=function(o,i){return r.forEach(function(e){if(i.prototype[e]){var r=Object.getOwnPropertyDescriptor(i.prototype,e);r.value&&(r.value=n.bind(r.value||i.prototype[e]),t._redefineProperty(i.prototype,e,r))}}),e.apply(document,[o,i])}}},t.eventNames="copy cut paste abort blur focus canplay canplaythrough change click contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop durationchange emptied ended input invalid keydown keypress keyup load loadeddata loadedmetadata loadstart message mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup pause play playing progress ratechange reset scroll seeked seeking select show stalled submit suspend timeupdate volumechange waiting mozfullscreenchange mozfullscreenerror mozpointerlockchange mozpointerlockerror error webglcontextrestored webglcontextlost webglcontextcreationerror".split(" "),t.onEventNames=t.eventNames.map(function(e){return"on"+e}),t.init=function(){e.zone=n=new t,t.patch()},window.Zone&&console.warn("Zone already exported on window the object!"),t.init(),e.Zone=t}("undefined"!=typeof module&&module&&module.exports?module.exports:window);