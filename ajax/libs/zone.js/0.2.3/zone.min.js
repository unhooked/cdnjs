"use strict";function Zone(e,n){var t=arguments.length?Object.create(e):this;return t.parent=e,Object.keys(n||{}).forEach(function(o){var r=o.substr(1);"$"===o[0]?t[r]=n[o](e[r]||function(){}):"+"===o[0]?e[r]?t[r]=function(){var t=e[r].apply(this,arguments);return n[o].apply(this,arguments),t}:t[r]=n[o]:"-"===o[0]?e[r]?t[r]=function(){return n[o].apply(this,arguments),e[r].apply(this,arguments)}:t[r]=n[o]:t[o]="object"==typeof n[o]?JSON.parse(JSON.stringify(n[o])):n[o]}),t}Zone.prototype={constructor:Zone,fork:function(e){return this.onZoneCreated(),new Zone(this,e)},bind:function(e,n){n||this.enqueueTask(e);var t=this.fork();return function(){return t.run(e,this,arguments)}},bindOnce:function(e){return this.bind(function(){var n=e.apply(this,arguments);return zone.dequeueTask(e),n})},run:function(e,n,t){t=t||[];var o,r=window.zone;window.zone=this;try{this.beforeTask(),o=e.apply(n,t)}catch(i){if(!zone.onError)throw i;zone.onError(i)}finally{this.afterTask(),window.zone=r}return o},beforeTask:function(){},onZoneCreated:function(){},afterTask:function(){},enqueueTask:function(){},dequeueTask:function(){}},Zone.patchSetClearFn=function(e,n){n.map(function(e){return e[0].toUpperCase()+e.substr(1)}).forEach(function(n){var t="set"+n,o="clear"+n,r=e[t];if(r){var i={};"setInterval"===t?zone[t]=function(n){var t;arguments[0]=function(){return delete i[t],n.apply(this,arguments)};var o=Zone.bindArguments(arguments);return t=r.apply(e,o),i[t]=!0,t}:zone[t]=function(n){var t;arguments[0]=function(){return delete i[t],n.apply(this,arguments)};var o=Zone.bindArgumentsOnce(arguments);return t=r.apply(e,o),i[t]=!0,t},e[t]=function(){return zone[t].apply(this,arguments)};var a=e[o];zone[o]=function(e){return i[e]&&(delete i[e],zone.dequeueTask()),a.apply(this,arguments)},e[o]=function(){return zone[o].apply(this,arguments)}}})},Zone.patchSetFn=function(e,n){n.forEach(function(n){var t=e[n];t&&(zone[n]=function(n){arguments[0]=function(){return n.apply(this,arguments)};var o=Zone.bindArgumentsOnce(arguments);return t.apply(e,o)},e[n]=function(){return zone[n].apply(this,arguments)})})},Zone.patchPrototype=function(e,n){n.forEach(function(n){var t=e[n];t&&(e[n]=function(){return t.apply(this,Zone.bindArguments(arguments))})})},Zone.bindArguments=function(e){for(var n=e.length-1;n>=0;n--)"function"==typeof e[n]&&(e[n]=zone.bind(e[n]));return e},Zone.bindArgumentsOnce=function(e){for(var n=e.length-1;n>=0;n--)"function"==typeof e[n]&&(e[n]=zone.bindOnce(e[n]));return e},Zone.patchableFn=function(e,n){n.forEach(function(n){var t=e[n];zone[n]=function(){return t.apply(e,arguments)},e[n]=function(){return zone[n].apply(this,arguments)}})},Zone.patchProperty=function(e,n){var t=Object.getOwnPropertyDescriptor(e,n)||{enumerable:!0,configurable:!0};delete t.writable,delete t.value;var o=n.substr(2),r="_"+n;t.set=function(e){this[r]&&this.removeEventListener(o,this[r]),"function"==typeof e?(this[r]=e,this.addEventListener(o,e,!1)):this[r]=null},t.get=function(){return this[r]},Object.defineProperty(e,n,t)},Zone.patchProperties=function(e,n){(n||function(){var n=[];for(var t in e)n.push(t);return n}().filter(function(e){return"on"===e.substr(0,2)})).forEach(function(n){Zone.patchProperty(e,n)})},Zone.patchEventTargetMethods=function(e){var n=e.addEventListener;e.addEventListener=function(e,t){return arguments[1]=t._bound=zone.bind(t),n.apply(this,arguments)};var t=e.removeEventListener;e.removeEventListener=function(e,n){arguments[1]=arguments[1]._bound||arguments[1];var o=t.apply(this,arguments);return zone.dequeueTask(n),o}},Zone.patch=function(){Zone.patchSetClearFn(window,["timeout","interval","immediate"]),Zone.patchSetFn(window,["requestAnimationFrame","webkitRequestAnimationFrame"]),Zone.patchableFn(window,["alert","prompt"]),window.EventTarget?Zone.patchEventTargetMethods(window.EventTarget.prototype):["ApplicationCache","EventSource","FileReader","InputMethodContext","MediaController","MessagePort","Node","Performance","SVGElementInstance","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebKitNamedFlow","Window","Worker","WorkerGlobalScope","XMLHttpRequestEventTarget","XMLHttpRequestUpload"].filter(function(e){return window[e]}).map(function(e){return window[e].prototype}).forEach(Zone.patchEventTargetMethods),Zone.canPatchViaPropertyDescriptor()?Zone.patchViaPropertyDescriptor():(Zone.patchViaCapturingAllTheEvents(),Zone.patchClass("XMLHttpRequest")),window.Promise&&Zone.patchPrototype(Promise.prototype,["then","catch"]),Zone.patchMutationObserverClass("MutationObserver"),Zone.patchMutationObserverClass("WebKitMutationObserver"),Zone.patchRegisterElement()},Zone.canPatchViaPropertyDescriptor=function(){Object.defineProperty(HTMLElement.prototype,"onclick",{get:function(){return!0}});var e=document.createElement("div"),n=!!e.onclick;return Object.defineProperty(HTMLElement.prototype,"onclick",{}),n},Zone.patchViaPropertyDescriptor=function(){Zone.patchProperties(HTMLElement.prototype,Zone.onEventNames),Zone.patchProperties(XMLHttpRequest.prototype)},Zone.patchViaCapturingAllTheEvents=function(){Zone.eventNames.forEach(function(e){var n="on"+e;document.addEventListener(e,function(e){for(var t,o=e.target;o;)o[n]&&!o[n]._unbound&&(t=zone.bind(o[n]),t._unbound=o[n],o[n]=t),o=o.parentElement},!0)})},Zone.patchClass=function(e){var n=window[e];if(n){window[e]=function(){var e=Zone.bindArguments(arguments);switch(e.length){case 0:this._o=new n;break;case 1:this._o=new n(e[0]);break;case 2:this._o=new n(e[0],e[1]);break;case 3:this._o=new n(e[0],e[1],e[2]);break;case 4:this._o=new n(e[0],e[1],e[2],e[3]);break;default:throw new Error("what are you even doing?")}};var t,o=new n("MutationObserver"===e.substr(-16)?function(){}:void 0);for(t in o)!function(n){"function"==typeof o[n]?window[e].prototype[n]=function(){return this._o[n].apply(this._o,arguments)}:Object.defineProperty(window[e].prototype,n,{set:function(e){"function"==typeof e?this._o[n]=zone.bind(e):this._o[n]=e},get:function(){return this._o[n]}})}(t)}},Zone.patchMutationObserverClass=function(e){var n=window[e];if(n){window[e]=function(e){this._o=new n(zone.bind(e,!0))};var t=new n(function(){});window[e].prototype.disconnect=function(){var e=this._o.disconnect.apply(this._o,arguments);return this._active&&zone.dequeueTask(),this._active=!1,e},window[e].prototype.observe=function(){return this._active||zone.enqueueTask(),this._active=!0,this._o.observe.apply(this._o,arguments)};var o;for(o in t)!function(n){void 0===typeof window[e].prototype&&("function"==typeof t[n]?window[e].prototype[n]=function(){return this._o[n].apply(this._o,arguments)}:Object.defineProperty(window[e].prototype,n,{set:function(e){"function"==typeof e?this._o[n]=zone.bind(e):this._o[n]=e},get:function(){return this._o[n]}}))}(o)}},Zone.patchRegisterElement=function(){if("registerElement"in document){var e=document.registerElement,n=["createdCallback","attachedCallback","detachedCallback","attributeChangedCallback"];document.registerElement=function(t,o){return n.forEach(function(e){o.prototype[e]&&(o.prototype[e]=zone.bind(o.prototype[e]))}),e.apply(document,[t,o])}}},Zone.eventNames="copy cut paste abort blur focus canplay canplaythrough change click contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop durationchange emptied ended input invalid keydown keypress keyup load loadeddata loadedmetadata loadstart mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup pause play playing progress ratechange reset scroll seeked seeking select show stalled submit suspend timeupdate volumechange waiting mozfullscreenchange mozfullscreenerror mozpointerlockchange mozpointerlockerror error".split(" "),Zone.onEventNames=Zone.eventNames.map(function(e){return"on"+e}),Zone.init=function(){"undefined"!=typeof module&&module&&module.exports?module.exports=new Zone:window.zone=new Zone,Zone.patch()},Zone.init();