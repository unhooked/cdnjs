"use strict";function Zone(e,t){var n=arguments.length?Object.create(e):this;return n.parent=e,Object.keys(t||{}).forEach(function(o){var r=o.substr(1);"$"===o[0]?n[r]=t[o](e[r]||function(){}):"+"===o[0]?e[r]?n[r]=function(){var n=e[r].apply(this,arguments);return t[o].apply(this,arguments),n}:n[r]=t[o]:"-"===o[0]?e[r]?n[r]=function(){return t[o].apply(this,arguments),e[r].apply(this,arguments)}:n[r]=t[o]:n[o]=t[o]}),n}Zone.prototype={constructor:Zone,fork:function(e){return this.onZoneCreated(),new Zone(this,e)},bind:function(e){var t=this.fork();return function(){return t.run(e,this,arguments)}},run:function(e,t,n){n=n||[];var o,r=window.zone;window.zone=this;try{this.beforeTask(),o=e.apply(t,n)}catch(i){if(!zone.onError)throw i;zone.onError(i)}finally{this.afterTask(),window.zone=r}return o},beforeTask:function(){},onZoneCreated:function(){},afterTask:function(){}},Zone.patchFn=function(e,t){t.forEach(function(t){var n=e[t];n&&(zone[t]=function(){return n.apply(e,Zone.bindArguments(arguments))},e[t]=function(){return zone[t].apply(this,arguments)})})},Zone.patchPrototype=function(e,t){t.forEach(function(t){var n=e[t];n&&(e[t]=function(){return n.apply(this,Zone.bindArguments(arguments))})})},Zone.bindArguments=function(e){for(var t=e.length-1;t>=0;t--)"function"==typeof e[t]&&(e[t]=zone.bind(e[t]));return e},Zone.patchableFn=function(e,t){t.forEach(function(t){var n=e[t];zone[t]=function(){return n.apply(e,arguments)},e[t]=function(){return zone[t].apply(this,arguments)}})},Zone.patchProperty=function(e,t){var n=Object.getOwnPropertyDescriptor(e,t)||{enumerable:!0,configurable:!0};delete n.writable,delete n.value;var o=t.substr(2),r="_"+t;n.set=function(e){this[r]&&this.removeEventListener(o,this[r]),"function"==typeof e?(this[r]=e,this.addEventListener(o,e,!1)):this[r]=null},n.get=function(){return this[r]},Object.defineProperty(e,t,n)},Zone.patchProperties=function(e,t){(t||function(){var t=[];for(var n in e)t.push(n);return t}().filter(function(e){return"on"===e.substr(0,2)})).forEach(function(t){Zone.patchProperty(e,t)})},Zone.patchEventTargetMethods=function(e){var t=e.addEventListener;e.addEventListener=function(e,n){return arguments[1]=n._bound=zone.bind(n),t.apply(this,arguments)};var n=e.removeEventListener;e.removeEventListener=function(e,t){return arguments[1]=arguments[1]._bound||arguments[1],n.apply(this,arguments)}},Zone.patch=function(){Zone.patchFn(window,["setTimeout","setInterval","requestAnimationFrame","webkitRequestAnimationFrame"]),Zone.patchableFn(window,["alert","prompt"]),window.EventTarget?Zone.patchEventTargetMethods(window.EventTarget.prototype):["ApplicationCache","EventSource","FileReader","InputMethodContext","MediaController","MessagePort","Node","Performance","SVGElementInstance","SharedWorker","TextTrack","TextTrackCue","TextTrackList","WebKitNamedFlow","Window","Worker","WorkerGlobalScope","XMLHttpRequestEventTarget","XMLHttpRequestUpload"].filter(function(e){return window[e]}).map(function(e){return window[e].prototype}).forEach(Zone.patchEventTargetMethods),Zone.canPatchViaPropertyDescriptor()?Zone.patchViaPropertyDescriptor():(Zone.patchViaCapturingAllTheEvents(),Zone.patchClass("XMLHttpRequest")),window.Promise&&Zone.patchPrototype(Promise.prototype,["then","catch"]),Zone.patchClass("MutationObserver"),Zone.patchClass("WebKitMutationObserver")},Zone.canPatchViaPropertyDescriptor=function(){Object.defineProperty(HTMLElement.prototype,"onclick",{get:function(){return!0}});var e=document.createElement("div"),t=!!e.onclick;return Object.defineProperty(HTMLElement.prototype,"onclick",{}),t},Zone.patchViaPropertyDescriptor=function(){Zone.patchProperties(HTMLElement.prototype,Zone.eventNames.map(function(e){return"on"+e})),Zone.patchProperties(XMLHttpRequest.prototype)},Zone.patchViaCapturingAllTheEvents=function(){Zone.eventNames.forEach(function(e){var t="on"+e;document.addEventListener(e,function(e){for(var n,o=e.target;o;)o[t]&&!o[t]._unbound&&(n=zone.bind(o[t]),n._unbound=o[t],o[t]=n),o=o.parentElement},!0)})},Zone.patchClass=function(e){var t=window[e];if(t){window[e]=function(){var e=Zone.bindArguments(arguments);switch(e.length){case 0:this._o=new t;break;case 1:this._o=new t(e[0]);break;case 2:this._o=new t(e[0],e[1]);break;case 3:this._o=new t(e[0],e[1],e[2]);break;case 4:this._o=new t(e[0],e[1],e[2],e[3]);break;default:throw new Error("what are you even doing?")}};var n,o=new t("MutationObserver"===e.substr(-16)?function(){}:void 0);for(n in o)!function(t){"function"==typeof o[t]?window[e].prototype[t]=function(){return this._o[t].apply(this._o,arguments)}:Object.defineProperty(window[e].prototype,t,{set:function(e){"function"==typeof e?this._o[t]=zone.bind(e):this._o[t]=e},get:function(){return this._o[t]}})}(n)}},Zone.eventNames="copy cut paste abort blur focus canplay canplaythrough change click contextmenu dblclick drag dragend dragenter dragleave dragover dragstart drop durationchange emptied ended input invalid keydown keypress keyup load loadeddata loadedmetadata loadstart mousedown mouseenter mouseleave mousemove mouseout mouseover mouseup pause play playing progress ratechange reset scroll seeked seeking select show stalled submit suspend timeupdate volumechange waiting mozfullscreenchange mozfullscreenerror mozpointerlockchange mozpointerlockerror error".split(" "),Zone.init=function(){"undefined"!=typeof module&&module&&module.exports?module.exports=new Zone:window.zone=new Zone,Zone.patch()},Zone.init();