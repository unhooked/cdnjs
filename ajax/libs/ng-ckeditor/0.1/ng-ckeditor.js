angular.module("ngCkeditor",[]).directive("ckeditor",function(){return{restrict:"A",require:"ngModel",scope:!1,link:function(a,b,c,d){var e=c.ngModel,f=$(b);if(!angular.isUndefined(CKEDITOR)&&!angular.isUndefined(CKEDITOR.instances)){var g={toolbar:"full",toolbar_full:[{name:"basicstyles",items:["Bold","Italic","Strike","Underline"]},{name:"paragraph",items:["BulletedList","NumberedList","Blockquote"]},{name:"editing",items:["JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock"]},{name:"links",items:["Link","Unlink","Anchor"]},{name:"tools",items:["SpellChecker","Maximize"]},"/",{name:"styles",items:["Format","FontSize","TextColor","PasteText","PasteFromWord","RemoveFormat"]},{name:"insert",items:["Image","Table","SpecialChar"]},{name:"forms",items:["Outdent","Indent"]},{name:"clipboard",items:["Undo","Redo"]},{name:"document",items:["PageBreak","Source"]}],disableNativeSpellChecker:!1,uiColor:"#FAFAFA",height:"400px",width:"100%"};CKEDITOR.config.spellerPagesServerScript="/examples/spellcheck/handler.php",g=angular.extend(g,a[c.ckeditor]);var h=CKEDITOR.replace(f.get(0),g);b.bind("$destroy",function(){h.destroy(!1)}),h.on("instanceReady",function(){h.setData(d.$viewValue)}),h.on("pasteState",function(){d.$setViewValue(h.getData())}),h.on("change",function(){d.$setViewValue(h.getData()),a.$$phase||a.$apply()}),d.$render=function(){h.setData(d.$viewValue)},a.$watch(e,function(){h&&a[e]!=h.getData()&&h.setData(d.$viewValue)}),a.$watch(function(){return b?h.getData():null},function(){d.$setViewValue(h.getData())}),h.on("blur",function(){a.$$phase||a.$apply()})}}}}),CKEDITOR.plugins.add("backup",{init:function(a){a.on("instanceReady",function(){var b=document.createElement("div"),c=0,d="display:inline-block; margin-left:10px;position:relative;margin-top:5px;overflow:hidden;float:right;",e="backup_"+a.name,f=!0,g="";b.setAttribute("style",d),void 0==localStorage.getItem(e)&&localStorage.setItem(e,"{}");var h=function(a){var b=new Date(parseInt(a)),c=function(a){return 10>a&&(a="0"+a),a};return b.getHours()+"."+c(b.getMinutes())+"."+c(b.getSeconds())};a.backup=function(b){var d=!1,i=(new Date).getTime(),j={};if("del"!=b){var k=a.getSnapshot();""!=k&&localStorage.getItem(e)&&g&&k!=g&&(j=JSON.parse(localStorage.getItem(e)),j[i]=k,localStorage.setItem(e,JSON.stringify(j)),d=!0)}else confirm("Вы уверены, что хотите удалить весь бекап?")&&(localStorage.setItem(e,"{}"),d=!0);if(d||f){f&&localStorage.getItem(e)&&(j=JSON.parse(localStorage.getItem(e)));var l="<option>---</option>";for(var m in j)l+='<option value="'+m+'">'+h(m)+"</option>";c.setHtml(l),f=!1}g=k},a.restore=function(){var b=a.getSnapshot(),d=c.getValue(),f=JSON.parse(localStorage.getItem(e));void 0==f[d]||""!=b&&!confirm("Вы уверены, что хотите заменить имеющийся текст, текстом из бекапа?")||a.loadSnapshot(f[d])};var i=0;a.on("change",function(){clearTimeout(i),i=setTimeout(function(){a.backup()},3e3)}),b.innerHTML='<select style="margin-top:-5px;" id="backuper_'+a.name+'"></select>&nbsp;<input type="image" value="del" onclick="CKEDITOR.instances[\''+a.name+"'].backup('del'); return false;\" src=\""+CKEDITOR.basePath+'plugins/backup/clear.png"/>',b.onchange=a.restore,CKEDITOR.document.getById(a.ui.spaceId?a.ui.spaceId("bottom"):"cke_bottom_"+a.name).append(new CKEDITOR.dom.node(b)),c=CKEDITOR.document.getById("backuper_"+a.name),a.backup()})}}),CKEDITOR.plugins.add("onchange",{init:function(a){function b(){a.readOnly||c||(c=setTimeout(function(){c=0,a.fire("change")},a.config.minimumChangeMilliseconds||100))}var c,d,e=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;a.on("destroy",function(){c&&clearTimeout(c),c=null}),a.on("saveSnapshot",function(a){a.data&&a.data.contentOnly||b()});var f=a.getCommand("undo");f&&f.on("afterUndo",b);var g=a.getCommand("redo");g&&g.on("afterRedo",b),a.on("afterCommandExec",function(a){"source"!=a.data.name&&a.data.command.canUndo!==!1&&b()}),e&&(d=new e(function(){b()}),window.console&&window.console.log&&console.log("Detecting changes using MutationObservers")),a.on("contentDom",function(){if(d)var c=setInterval(function(){"object"==typeof a.document&&(d.observe(a.document.getBody().$,{attributes:!0,childList:!0,characterData:!0}),clearInterval(c))},100);a.document.on("keydown",function(a){if(!a.data.$.ctrlKey&&!a.data.$.metaKey){var c=a.data.$.keyCode;(8==c||13==c||32==c||c>=46&&90>=c||c>=96&&111>=c||c>=186&&222>=c||229==c)&&b()}}),a.document.on("drop",b),a.document.getBody().on("drop",b)}),a.on("mode",function(){if("source"==a.mode){var c=a.textarea||a._.editable;c.on("keydown",function(a){a.data.$.ctrlKey||a.data.$.metaKey||b()}),c.on("drop",b),c.on("input",b),CKEDITOR.env.ie&&(c.on("cut",b),c.on("paste",b))}})}}),angular.module("ngCkeditor").run(["$templateCache",function(){}]);
/*
//@ sourceMappingURL=ng-ckeditor.map
*/