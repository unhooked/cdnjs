{"version":3,"sources":["smartcrop.js"],"names":["SmartCrop","options","this","extend","DEFAULTS","o","i","i_len","arguments","length","arg","name","hasOwnProperty","thirds","x","Math","max","width","height","aspect","cropWidth","cropHeight","detailWeight","skinColor","skinBias","skinBrightnessMin","skinBrightnessMax","skinThreshold","skinWeight","saturationBrightnessMin","saturationBrightnessMax","saturationThreshold","saturationBias","saturationWeight","scoreDownSample","step","scaleStep","minScale","maxScale","edgeRadius","edgeWeight","outsideImportance","ruleOfThirds","prescale","canvasFactory","debug","crop","image","callback","naturalWidth","naturalHeight","c","canvas","cctx","getContext","drawImage","scale","min","smartCrop","prescaledCanvas","ctx","result","analyse","crops","y","prototype","w","h","document","createElement","saturation","r","g","b","maximum","minumum","l","d","cie","edgeDetect","sample","p","id","data","od","lightness","skinDetect","skin","saturationDetect","minDimension","push","score","output","detail","total","downSample","invDownSample","importance","_score","px","abs","py","dx","dy","s","sqrt","mag","rd","gd","bd","input","getImageData","scoreCanvas","ceil","scoreCtx","putImageData","scoreOutput","topScore","Infinity","topCrop","fillStyle","fillRect","strokeStyle","strokeRect","debugCanvas","define","amd","exports","navigator","module"],"mappings":"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","file":"smartcrop.min.js"}