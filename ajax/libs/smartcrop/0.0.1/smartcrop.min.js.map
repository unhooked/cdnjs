{"version":3,"sources":["smartcrop.js"],"names":["SmartCrop","options","this","extend","DEFAULTS","o","i","i_len","arguments","length","arg","name","thirds","x","Math","max","cie","r","g","b","sample","id","p","saturation","maximum","minumum","min","l","d","width","height","aspect","cropWidth","cropHeight","detailWeight","skinColor","skinBias","skinBrightnessMin","skinBrightnessMax","skinThreshold","skinWeight","saturationBrightnessMin","saturationBrightnessMax","saturationThreshold","saturationBias","saturationWeight","scoreDownSample","step","scaleStep","minScale","maxScale","edgeRadius","edgeWeight","outsideImportance","ruleOfThirds","prescale","canvasFactory","debug","crop","image","callback","naturalWidth","naturalHeight","c","canvas","cctx","getContext","drawImage","scale","smartCrop","prescaledCanvas","ctx","result","analyse","crops","y","isAvailable","s","e","prototype","w","h","document","createElement","edgeDetect","data","od","lightness","skinDetect","skin","saturationDetect","sat","minDimension","push","score","output","detail","total","downSample","invDownSample","outputHeightDownSample","outputWidthDownSample","outputWidth","importance","px","abs","py","dx","dy","sqrt","mag","rd","gd","bd","input","getImageData","scoreCanvas","ceil","scoreCtx","putImageData","scoreOutput","topScore","Infinity","topCrop","fillStyle","fillRect","strokeStyle","strokeRect","debugCanvas","define","amd","exports","navigator","window","module"],"mappings":"CAyBA,WACA,YAEA,SAASA,GAAUC,GAChBC,KAAKD,QAAUE,KAAWH,EAAUI,SAAUH,GA+TjD,QAASE,GAAOE,GACZ,IAAI,GAAIC,GAAI,EAAGC,EAAQC,UAAUC,OAAYF,EAAJD,EAAWA,IAAK,CACrD,GAAII,GAAMF,UAAUF,EACpB,IAAGI,EACC,IAAI,GAAIC,KAAQD,GACZL,EAAEM,GAAQD,EAAIC,GAI1B,MAAON,GAKX,QAASO,GAAOC,GAEZ,MADAA,GAAgC,KAA1BA,EAAG,EAAE,EAAG,GAAK,EAAI,GAAI,IACpBC,KAAKC,IAAI,EAAIF,EAAEA,EAAG,GAG7B,QAASG,GAAIC,EAAGC,EAAGC,GACf,MAAO,MAAOA,EAAI,MAAOD,EAAI,MAAOD,EAExC,QAASG,GAAOC,EAAIC,GAChB,MAAON,GAAIK,EAAGC,GAAID,EAAGC,EAAE,GAAID,EAAGC,EAAE,IAEpC,QAASC,GAAWN,EAAGC,EAAGC,GACtB,GAAIK,GAAUT,EAAIE,EAAE,IAAKC,EAAE,IAAKC,EAAE,KAAMM,EAAUC,EAAIT,EAAE,IAAKC,EAAE,IAAKC,EAAE,IACtE,IAAGK,IAAYC,EACX,MAAO,EAEX,IAAIE,IAAKH,EAAUC,GAAW,EAC1BG,EAAIJ,EAAQC,CAChB,OAAOE,GAAI,GAAMC,GAAG,EAAEJ,EAAQC,GAAWG,GAAGJ,EAAQC,GA7VxDzB,EAAUI,UACNyB,MAAO,EACPC,OAAQ,EACRC,OAAQ,EACRC,UAAW,EACXC,WAAY,EACZC,aAAc,GACdC,WAAY,IAAM,IAAM,KACxBC,SAAU,IACVC,kBAAmB,GACnBC,kBAAmB,EACnBC,cAAe,GACfC,WAAY,IACZC,wBAAyB,IACzBC,wBAAyB,GACzBC,oBAAqB,GACrBC,eAAgB,GAChBC,iBAAkB,GAElBC,gBAAiB,EACjBC,KAAM,EACNC,UAAW,GACXC,SAAU,GACVC,SAAU,EACVC,WAAY,GACZC,WAAY,IACZC,mBAAoB,GACpBC,cAAc,EACdC,UAAU,EACVC,cAAe,KACfC,OAAO,GAEXzD,EAAU0D,KAAO,SAASC,EAAO1D,EAAS2D,GAOtC,GANG3D,EAAQ8B,SACP9B,EAAQ4B,MAAQ5B,EAAQ8B,OACxB9B,EAAQ6B,OAAS,GAIlB6B,EAAME,eAAiBF,EAAME,cAAgBF,EAAM9B,OAAS8B,EAAMG,eAAiBH,EAAM7B,QAAQ,CAChG,GAAIiC,GAAI,GAAI/D,GAAUC,GAAS+D,OAAOL,EAAME,aAAcF,EAAMG,eAC5DG,EAAOF,EAAEG,WAAW,KACxBH,GAAElC,MAAQ8B,EAAME,aAChBE,EAAEjC,OAAS6B,EAAMG,cACjBG,EAAKE,UAAUR,EAAO,EAAG,GACzBA,EAAQI,EAGZ,GAAIK,GAAQ,EACRb,EAAW,CACZtD,GAAQ4B,OAAS5B,EAAQ6B,SACxBsC,EAAQ1C,EAAIiC,EAAM9B,MAAM5B,EAAQ4B,MAAO8B,EAAM7B,OAAO7B,EAAQ6B,QAC5D7B,EAAQ+B,aAAe/B,EAAQ4B,MAAQuC,GACvCnE,EAAQgC,cAAgBhC,EAAQ6B,OAASsC,GAIzCnE,EAAQgD,SAAWvB,EAAIzB,EAAQiD,UAAYlD,EAAUI,SAAS8C,SAAUnC,EAAI,EAAEqD,EAAQnE,EAAQgD,UAAUjD,EAAUI,SAAS6C,WAE/H,IAAIoB,GAAY,GAAIrE,GAAUC,EAC9B,IAAGA,EAAQ4B,OAAS5B,EAAQ6B,QACrB7B,EAAQsD,YAAa,EAEpB,GADAA,EAAW,EAAEa,EAAMnE,EAAQgD,SACb,EAAXM,EAAc,CACb,GAAIe,GAAkBD,EAAUL,OAAOL,EAAM9B,MAAM0B,EAAUI,EAAM7B,OAAOyB,GACtEgB,EAAMD,EAAgBJ,WAAW,KACrCK,GAAIJ,UAAUR,EAAO,EAAG,EAAGA,EAAM9B,MAAO8B,EAAM7B,OAAQ,EAAG,EAAGwC,EAAgBzC,MAAOyC,EAAgBxC,QACnG6B,EAAQW,EACRD,EAAUpE,QAAQ+B,aAAe/B,EAAQ+B,UAAUuB,GACnDc,EAAUpE,QAAQgC,cAAgBhC,EAAQgC,WAAWsB,OAGrDA,GAAW,CAKvB,KAAI,GADAiB,GAASH,EAAUI,QAAQd,GACvBrD,EAAI,EAAGC,EAAQiE,EAAOE,MAAMjE,OAAYF,EAAJD,EAAWA,IAAK,CACxD,GAAIoD,GAAOc,EAAOE,MAAMpE,EACxBoD,GAAK7C,KAAO6C,EAAK7C,EAAE0C,GACnBG,EAAKiB,KAAOjB,EAAKiB,EAAEpB,GACnBG,EAAK7B,SAAW6B,EAAK7B,MAAM0B,GAC3BG,EAAK5B,UAAY4B,EAAK5B,OAAOyB,GAGjC,MADAK,GAASY,GACFA,GAGXxE,EAAU4E,YAAc,SAAS3E,GAC7B,IACI,GAAI4E,GAAI,GAAI3E,MAAKD,GACb8D,EAAIc,EAAEb,OAAO,GAAI,GACrB,OAA2B,kBAAjBD,GAAEG,WAGhB,MAAMY,GACF,OAAO,IAGf9E,EAAU+E,WACNf,OAAQ,SAASgB,EAAGC,GAChB,GAAkC,OAA/B/E,KAAKD,QAAQuD,cACZ,MAAOtD,MAAKD,QAAQuD,cAAcwB,EAAGC,EAEzC,IAAIlB,GAAImB,SAASC,cAAc,SAG/B,OAFApB,GAAElC,MAAQmD,EACVjB,EAAEjC,OAASmD,EACJlB,GAEXqB,WAAY,SAAS9E,EAAGD,GAKpB,IAAI,GAJAgB,GAAKf,EAAE+E,KACPC,EAAKjF,EAAEgF,KACPL,EAAI1E,EAAEuB,MACNoD,EAAI3E,EAAEwB,OACF6C,EAAI,EAAOM,EAAJN,EAAOA,IAClB,IAAI,GAAI9D,GAAI,EAAOmE,EAAJnE,EAAOA,IAAK,CACvB,GACI0E,GADAjE,EAAY,GAAPqD,EAAEK,EAAEnE,EAGT0E,GADK,IAAN1E,GAAWA,GAAKmE,EAAE,GAAW,IAANL,GAAWA,GAAKM,EAAE,EAC5B7D,EAAOC,EAAIC,GAGG,EAAdF,EAAOC,EAAIC,GAAOF,EAAOC,EAAIC,EAAI,EAAF0D,GAAO5D,EAAOC,EAAIC,EAAE,GAAKF,EAAOC,EAAIC,EAAE,GAAKF,EAAOC,EAAIC,EAAI,EAAF0D,GAEvGM,EAAGhE,EAAE,GAAKiE,IAItBC,WAAY,SAASlF,EAAGD,GAMpB,IAAI,GALAgB,GAAKf,EAAE+E,KACPC,EAAKjF,EAAEgF,KACPL,EAAI1E,EAAEuB,MACNoD,EAAI3E,EAAEwB,OACN7B,EAAUC,KAAKD,QACX0E,EAAI,EAAOM,EAAJN,EAAOA,IAClB,IAAI,GAAI9D,GAAI,EAAOmE,EAAJnE,EAAOA,IAAK,CACvB,GAAIS,GAAY,GAAPqD,EAAEK,EAAEnE,GACT0E,EAAYvE,EAAIK,EAAGC,GAAID,EAAGC,EAAE,GAAID,EAAGC,EAAE,IAAI,IACzCmE,EAAOvF,KAAKiC,UAAUd,EAAGC,GAAID,EAAGC,EAAE,GAAID,EAAGC,EAAE,GAC5CmE,GAAOxF,EAAQsC,eAAiBgD,GAAatF,EAAQoC,mBAAqBkD,GAAatF,EAAQqC,kBAC9FgD,EAAGhE,IAAMmE,EAAKxF,EAAQsC,gBAAgB,KAAK,EAAEtC,EAAQsC,gBAGrD+C,EAAGhE,GAAK,IAKxBoE,iBAAkB,SAASpF,EAAGD,GAM1B,IAAI,GALAgB,GAAKf,EAAE+E,KACPC,EAAKjF,EAAEgF,KACPL,EAAI1E,EAAEuB,MACNoD,EAAI3E,EAAEwB,OACN7B,EAAUC,KAAKD,QACX0E,EAAI,EAAOM,EAAJN,EAAOA,IAClB,IAAI,GAAI9D,GAAI,EAAOmE,EAAJnE,EAAOA,IAAK,CACvB,GAAIS,GAAY,GAAPqD,EAAEK,EAAEnE,GACT0E,EAAYvE,EAAIK,EAAGC,GAAID,EAAGC,EAAE,GAAID,EAAGC,EAAE,IAAI,IACzCqE,EAAMpE,EAAWF,EAAGC,GAAID,EAAGC,EAAE,GAAID,EAAGC,EAAE,GACvCqE,GAAM1F,EAAQ0C,qBAAuB4C,GAAatF,EAAQwC,yBAA2B8C,GAAatF,EAAQyC,wBACzG4C,EAAGhE,EAAE,IAAMqE,EAAI1F,EAAQ0C,sBAAsB,KAAK,EAAE1C,EAAQ0C,sBAG5D2C,EAAGhE,EAAE,GAAK,IAK1BoD,MAAO,SAASf,GAQZ,IAAI,GAPAe,MACA7C,EAAQ8B,EAAM9B,MACdC,EAAS6B,EAAM7B,OACf7B,EAAUC,KAAKD,QACf2F,EAAelE,EAAIG,EAAOC,GAC1BE,EAAY/B,EAAQ+B,WAAa4D,EACjC3D,EAAahC,EAAQgC,YAAc2D,EAC/BxB,EAAQnE,EAAQiD,SAAUkB,GAASnE,EAAQgD,SAAUmB,GAASnE,EAAQ+C,UAC1E,IAAI,GAAI2B,GAAI,EAAyB7C,GAAtB6C,EAAE1C,EAAWmC,EAAiBO,GAAG1E,EAAQ8C,KACpD,IAAI,GAAIlC,GAAI,EAAwBgB,GAArBhB,EAAEmB,EAAUoC,EAAgBvD,GAAGZ,EAAQ8C,KAClD2B,EAAMmB,MACFhF,EAAGA,EACH8D,EAAGA,EACH9C,MAAOG,EAAUoC,EACjBtC,OAAQG,EAAWmC,GAKnC,OAAOM,IAEXoB,MAAO,SAASC,EAAQrC,GAcpB,IAAI,GAbAoC,IACIE,OAAQ,EACRzE,WAAY,EACZkE,KAAM,EACNQ,MAAO,GAEXhG,EAAUC,KAAKD,QACfqF,EAAKS,EAAOV,KACZa,EAAajG,EAAQ6C,gBACrBqD,EAAgB,EAAED,EAClBE,EAAyBL,EAAOjE,OAAOoE,EACvCG,EAAwBN,EAAOlE,MAAMqE,EACrCI,EAAcP,EAAOlE,MACjB8C,EAAI,EAAOyB,EAAJzB,EAA4BA,GAAGuB,EAC1C,IAAI,GAAIrF,GAAI,EAAOwF,EAAJxF,EAA2BA,GAAGqF,EAAY,CACrD,GAAI5E,GAA0D,MAAlDqD,EAAEwB,GAAeG,KAAezF,EAAEsF,IAC1CI,EAAarG,KAAKqG,WAAW7C,EAAM7C,EAAG8D,GACtCqB,EAASV,EAAGhE,EAAE,GAAG,GACrBwE,GAAML,MAAQH,EAAGhE,GAAG,KAAK0E,EAAO/F,EAAQmC,UAAUmE,EAClDT,EAAME,QAAUA,EAAOO,EACvBT,EAAMvE,YAAc+D,EAAGhE,EAAE,GAAG,KAAK0E,EAAO/F,EAAQ2C,gBAAgB2D,EAKxE,MADAT,GAAMG,OAASH,EAAME,OAAO/F,EAAQiC,aAAe4D,EAAML,KAAKxF,EAAQuC,WAAasD,EAAMvE,WAAWtB,EAAQ4C,kBAAkBa,EAAK7B,MAAM6B,EAAK5B,OACvIgE,GAEXS,WAAY,SAAS7C,EAAM7C,EAAG8D,GAC1B,GAAI1E,GAAUC,KAAKD,OAEnB,IAAIyD,EAAK7C,EAAIA,GAAKA,GAAK6C,EAAK7C,EAAE6C,EAAK7B,OAAS6B,EAAKiB,EAAIA,GAAKA,GAAKjB,EAAKiB,EAAEjB,EAAK5B,OAAQ,MAAO7B,GAAQoD,iBAClGxC,IAAKA,EAAE6C,EAAK7C,GAAG6C,EAAK7B,MACpB8C,GAAKA,EAAEjB,EAAKiB,GAAGjB,EAAK5B,MACpB,IAAI0E,GAAgB,EAAXC,EAAI,GAAI5F,GACb6F,EAAgB,EAAXD,EAAI,GAAI9B,GAEbgC,EAAK7F,KAAKC,IAAIyF,EAAG,EAAIvG,EAAQkD,WAAY,GACzCyD,EAAK9F,KAAKC,IAAI2F,EAAG,EAAIzG,EAAQkD,WAAY,GACzCvB,GAAK+E,EAAGA,EAAGC,EAAGA,GAAI3G,EAAQmD,WAC1ByB,EAAI,KAAKgC,EAAKL,EAAGA,EAAGE,EAAGA,EAI3B,OAHGzG,GAAQqD,eACPuB,GAA2B,IAArB/D,KAAKC,IAAI,EAAG8D,EAAEjD,EAAE,KAAWhB,EAAO4F,GAAI5F,EAAO8F,KAEhD7B,EAAEjD,GAEbO,UAAW,SAASlB,EAAGC,EAAGC,GACtB,GAAI2F,GAAMD,EAAK5F,EAAEA,EAAEC,EAAEA,EAAEC,EAAEA,GACrBlB,EAAUC,KAAKD,QACf8G,EAAM9F,EAAE6F,EAAI7G,EAAQkC,UAAU,GAC9B6E,EAAM9F,EAAE4F,EAAI7G,EAAQkC,UAAU,GAC9B8E,EAAM9F,EAAE2F,EAAI7G,EAAQkC,UAAU,GAC9BP,EAAIiF,EAAKE,EAAGA,EAAGC,EAAGA,EAAGC,EAAGA,EACxB,OAAO,GAAErF,GAEjB6C,QAAS,SAASd,GACd,GAAIa,MACAvE,EAAUC,KAAKD,QACf+D,EAAS9D,KAAK8D,OAAOL,EAAM9B,MAAO8B,EAAM7B,QACxCyC,EAAMP,EAAOE,WAAW,KAC5BK,GAAIJ,UAAUR,EAAO,EAAG,EACxB,IAAIuD,GAAQ3C,EAAI4C,aAAa,EAAG,EAAGnD,EAAOnC,MAAOmC,EAAOlC,QACpDiE,EAASxB,EAAI4C,aAAa,EAAG,EAAGnD,EAAOnC,MAAOmC,EAAOlC,OACzD5B,MAAKkF,WAAW8B,EAAOnB,GACvB7F,KAAKsF,WAAW0B,EAAOnB,GACvB7F,KAAKwF,iBAAiBwB,EAAOnB,EAE7B,IAAIqB,GAAclH,KAAK8D,OAAOqD,EAAK1D,EAAM9B,MAAM5B,EAAQ6C,iBAAkBuE,EAAK1D,EAAM7B,OAAO7B,EAAQ6C,kBAC/FwE,EAAWF,EAAYlD,WAAW,KAEtCK,GAAIgD,aAAaxB,EAAQ,EAAG,GAC5BuB,EAASnD,UAAUH,EAAQ,EAAG,EAAGA,EAAOnC,MAAOmC,EAAOlC,OAAQ,EAAG,EAAGsF,EAAYvF,MAAOuF,EAAYtF,OAQnG,KAAI,GANA0F,GAAcF,EAASH,aAAa,EAAG,EAAGC,EAAYvF,MAAOuF,EAAYtF,QAEzE2F,IAAYC,EAAAA,GACZC,EAAU,KACVjD,EAAQxE,KAAKwE,MAAMf,GAEfrD,EAAI,EAAGC,EAAQmE,EAAMjE,OAAYF,EAAJD,EAAWA,IAAK,CACjD,GAAIoD,GAAOgB,EAAMpE,EACjBoD,GAAKoC,MAAQ5F,KAAK4F,MAAM0B,EAAa9D,GAClCA,EAAKoC,MAAMG,MAAQwB,IAClBE,EAAUjE,EACV+D,EAAW/D,EAAKoC,MAAMG,OAQ9B,GAHAzB,EAAOE,MAAQA,EACfF,EAAOmD,QAAUA,EAEd1H,EAAQwD,OAASkE,EAAQ,CACxBpD,EAAIqD,UAAY,uBAChBrD,EAAIsD,SAASF,EAAQ9G,EAAG8G,EAAQhD,EAAGgD,EAAQ9F,MAAO8F,EAAQ7F,OAEtD,KAAI,GAAI6C,GAAI,EAAGA,EAAIoB,EAAOjE,OAAQ6C,IAC9B,IAAI,GAAI9D,GAAI,EAAGA,EAAIkF,EAAOlE,MAAOhB,IAAK,CAClC,GAAIS,GAAuB,GAAlBqD,EAAEoB,EAAOlE,MAAMhB,GACpB0F,EAAarG,KAAKqG,WAAWoB,EAAS9G,EAAG8D,EAC1C4B,GAAa,IACZR,EAAOV,KAAK/D,EAAE,IAAiB,GAAXiF,GAGR,EAAbA,IACCR,EAAOV,KAAK/D,IAAiB,IAAXiF,GAEtBR,EAAOV,KAAK/D,EAAE,GAAK,IAG3BiD,EAAIgD,aAAaxB,EAAQ,EAAG,GAEhCxB,EAAIuD,YAAc,uBAClBvD,EAAIwD,WAAWJ,EAAQ9G,EAAG8G,EAAQhD,EAAGgD,EAAQ9F,MAAO8F,EAAQ7F,QAC5D0C,EAAOwD,YAAchE,EAEzB,MAAOQ,IAKf,IAAI9C,GAAMZ,KAAKY,IACXX,EAAMD,KAAKC,IACX0F,EAAM3F,KAAK2F,IACXY,EAAOvG,KAAKuG,KACZR,EAAO/F,KAAK+F,IA2CM,oBAAXoB,SAA0BA,OAAOC,KAAKD,OAAO,WAAW,MAAOjI,KAEnD,mBAAZmI,SAAyBA,QAAQnI,UAAYA,EAE1B,mBAAdoI,aAA2BC,OAAOrI,UAAYA,GAExC,mBAAXsI,UACPA,OAAOH,QAAUnI","file":"smartcrop.min.js"}