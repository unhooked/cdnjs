!function(e,n,t){"use strict";var o,i=function(e){o=this,o.userOptions=e||{},o.settings={modal:".modal",modalInner:".modal-inner",modalContent:".modal-content",open:'[rel="modal:open"]',close:'[rel="modal:close"]',parent:"body","class":"modal-visible",href:!1,clickOutside:!1,transitions:!0,onBeforeOpen:function(){},onBeforeClose:function(){},onOpen:function(){},onClose:function(){}},o.DOM={},o.isOpen=!1,o.transitionEnd=null;try{o.sniffTransitionEnd(),o.bootstrap(),o.prepareDOM(),o.addParentAttr(),o.attachEvents()}catch(n){}return this};i.prototype={sniffTransitionEnd:function(){var e=n.createElement("div"),i={transition:"transitionend",OTransition:"otransitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(var s in i)if(i.hasOwnProperty(s)&&e.style[s]!==t)return o.transitionEnd=i[s]},bootstrap:function(){if("object"==typeof o.userOptions)for(var e in o.userOptions)o.settings[e]=o.userOptions[e]},prepareDOM:function(){o.DOM.modal=n.querySelector(o.settings.modal),o.DOM.modalInner=o.DOM.modal.querySelector(o.settings.modalInner),o.DOM.modalContent=o.DOM.modal.querySelector(o.settings.modalContent),o.DOM.open=n.querySelectorAll(o.settings.open),o.DOM.close=n.querySelectorAll(o.settings.close),o.DOM.parent=n.querySelector(o.settings.parent)},addParentAttr:function(){o.DOM.parent.setAttribute("data-gets-modal","")},addClass:function(e,n){if(!(!e instanceof HTMLElement)){var t=e.className.split(" ");-1===t.indexOf(n)&&t.push(n),e.className=t.join(" ")}},removeClass:function(e,n){if(!(!e instanceof HTMLElement)){var t=e.className.split(" ");t.indexOf(n)>-1&&t.splice(t.indexOf(n),1),e.className=t.join(" ")}},open:function(e){if("string"==typeof e)o.settings.href=n.querySelector(e);else if(e instanceof MouseEvent&&"string"==typeof this.hash)o.settings.href=n.querySelector(this.hash),e.preventDefault();else{if("undefined"==typeof o.settings.href)return;if("string"==typeof o.settings.href&&(o.settings.href=n.querySelector(o.settings.href)),!o.settings.href||!o.settings.href.length||!o.settings.href instanceof HTMLElement)return}"function"==typeof o.settings.onBeforeOpen&&o.settings.onBeforeOpen.bind(o),o.acquireDOMNode(),o.addClass(o.DOM.parent,o.settings["class"]);var t=o.settings.href.id?o.settings.href.id:"anonymous";return o.DOM.parent.setAttribute("data-current-modal",t),o.isOpen=!0,"function"==typeof o.settings.onOpen&&o.settings.onOpen.bind(o),o},close:function(e){return e&&e.preventDefault(),"function"==typeof o.settings.onBeforeClose&&o.settings.onBeforeClose.bind(o),o.removeClass(o.DOM.parent,o.settings["class"]),o.transitionEnd&&o.settings.transitions!==!1?o.closeWithTransition():o.closeWithoutTransition(),o},transitionHandler:function(){o.DOM.modal.removeEventListener(o.transitionEnd,o.transitionHandler,!1),o.DOM.parent.removeAttribute("data-current-modal"),o.returnDOMNode(),o.isOpen=!1,"function"==typeof o.settings.onClose&&o.settings.onClose.bind(o)},closeWithTransition:function(){o.DOM.modal.addEventListener(o.transitionEnd,o.transitionHandler,!1)},closeWithoutTransition:function(){o.DOM.parent.removeAttribute("data-current-modal"),o.returnDOMNode(),o.isOpen=!1,"function"==typeof o.settings.onClose&&o.settings.onClose.bind(o)},acquireDOMNode:function(){if(o.settings.href)for(;o.settings.href.childNodes.length>0;)o.DOM.modalContent.appendChild(o.settings.href.childNodes[0])},returnDOMNode:function(){if(o.settings.href)for(;o.DOM.modalContent.childNodes.length>0;)o.settings.href.appendChild(o.DOM.modalContent.childNodes[0])},detectEscapeKey:function(e){27===e.keyCode&&o.isOpen===!0&&(e.preventDefault(),o.close())},modalClickHandler:function(e){for(var t=e.target;t!=n.body;){if(t===o.DOM.modalInner)return;t=t.parentNode}o.close()},attachEvents:function(){for(var e=0;e<o.DOM.open.length;e++)!function(e){o.DOM.open[e].addEventListener("click",o.open,!1)}(e);for(var e=0;e<o.DOM.close.length;e++)!function(e){o.DOM.close[e].addEventListener("click",o.close,!1)}(e);o.settings.clickOutside===!0&&o.DOM.modal.addEventListener("click",o.modalClickHandler,!1),n.addEventListener("keydown",o.detectEscapeKey,!1)},destroy:function(){o.close();for(var e=0;e<o.DOM.open.length;e++)!function(e){o.DOM.open[e].removeEventListener("click",o.open)}(e);for(var e=0;e<o.DOM.close.length;e++)!function(e){o.DOM.close[e].addEventListener("click",o.close)}(e);o.settings.clickOutside===!0&&o.DOM.modal.removeEventListener("click",o.modalClickHandler),n.removeEventListener("keydown",o.detectEscapeKey)}},"function"==typeof define&&define.amd?define("vanillaModal",function(){return i}):"undefined"!=typeof module&&module.exports?module.exports=i:e.VanillaModal=i}(window,document);