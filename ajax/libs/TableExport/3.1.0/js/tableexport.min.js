/*!
 * TableExport.js v3.1.0 (http://www.clarketravis.com)
 * Copyright 2015 Travis Clarke
 * Licensed under the MIT license
 */
function dateNum(t,e){e&&(t+=1462);var n=Date.parse(t);return(n-new Date(Date.UTC(1899,11,30)))/864e5}function createSheet(t,e){for(var n={},a={s:{c:1e7,r:1e7},e:{c:0,r:0}},o=0;o!=t.length;++o)for(var r=0;r!=t[o].length;++r){a.s.r>o&&(a.s.r=o),a.s.c>r&&(a.s.c=r),a.e.r<o&&(a.e.r=o),a.e.c<r&&(a.e.c=r);var l={v:t[o][r]};if(null!=l.v){var s=XLSX.utils.encode_cell({c:r,r:o});"number"==typeof l.v?l.t="n":"boolean"==typeof l.v?l.t="b":l.v instanceof Date?(l.t="n",l.z=XLSX.SSF._table[14],l.v=dateNum(l.v)):l.t="s",n[s]=l}}return a.s.c<1e7&&(n["!ref"]=XLSX.utils.encode_range(a)),n}function Workbook(){return this instanceof Workbook?(this.SheetNames=[],void(this.Sheets={})):new Workbook}function string2ArrayBuffer(t){for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),a=0;a!=t.length;++a)n[a]=255&t.charCodeAt(a);return e}function export2xlsx(t,e){var n=new Workbook,a=createSheet(t);n.SheetNames.push(e),n.Sheets[e]=a;var o={bookType:"xlsx",bookSST:!1,type:"binary"},r=XLSX.write(n,o);saveAs(new Blob([string2ArrayBuffer(r)],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),e+".xlsx")}!function(t,e){var n=t.jQuery;n.fn.tableExport=function(t){var e,a,o,r=n.extend({},n.fn.tableExport.defaults,t),l=n.fn.tableExport.rowDel;return r.bootstrap?(e=n.fn.tableExport.bootstrap[0]+" ",a=n.fn.tableExport.bootstrap[1]+" ",o=n.fn.tableExport.bootstrap[2]+" "):(e=n.fn.tableExport.defaultButton+" ",a=o=""),this.each(function(){function t(t){var e=u.find("caption:not(.head)");e.length?e.append(t):u.prepend('<caption class="'+o+r.position+'">'+t+"</caption>")}function s(n,o,r,l){var s="<a href='"+n+"' download='"+o+"' role='button' class='"+e+a+l+"'>"+r+"</a>";t(s)}function f(n,o,r,l){var s="<a href='#' data-obj='"+n+"' download='"+o+"' role='button' class='"+e+a+l+"'>"+r+"</a>";t(s),i(l)}function i(t){var e="."+t;return n(e).on("click",function(t){if(n(this).data("obj")){t.preventDefault();var e=n(this).data("obj"),a=e.data,o=e.name;export2xlsx(a,o)}})}var u=n(this),p=r.headings?u.find("tr"):u.find("tr:has(td)"),x="id"===r.fileName?u.attr("id")?u.attr("id"):n.fn.tableExport.defaultFileName:r.fileName,c={xlsx:function(t,e){var a=p.map(function(t,e){var a=n(e).find("th, td");return a.map(function(t,e){return n(e).text()})}).get(),o=JSON.stringify({data:a,name:e}),r=e+".xlsx",l=n.fn.tableExport.xlsx.buttonContent,s=n.fn.tableExport.xlsx.defaultClass;f(o,r,l,s)},xls:function(t,e){var a=n.fn.tableExport.xls.separator,o="data:application/vnd.ms-excel;charset=utf-16,"+encodeURIComponent(p.map(function(t,e){var o=n(e).find("th, td");return o.map(function(t,e){return n(e).html()}).get().join(a)}).get().join(t)),r=e+".xls",l=n.fn.tableExport.xls.buttonContent,f=n.fn.tableExport.xls.defaultClass;s(o,r,l,f)},csv:function(t,e){t='"'+t+'"';var a='"'+n.fn.tableExport.csv.separator+'"',o="data:text/csv;charset=utf-16,"+encodeURIComponent('"'+p.map(function(t,e){var o=n(e).find("th, td");return o.map(function(t,e){return n(e).text().replace(/"/g,'""')}).get().join(a)}).get().join(t)+'"'),r=e+".csv",l=n.fn.tableExport.csv.buttonContent,f=n.fn.tableExport.csv.defaultClass;s(o,r,l,f)},txt:function(t,e){var a=n.fn.tableExport.txt.separator,o="data:text/plain;charset=utf-16,"+encodeURIComponent(p.map(function(t,e){var o=n(e).find("th, td");return o.map(function(t,e){return n(e).text()}).get().join(a)}).get().join(t)),r=e+".txt",l=n.fn.tableExport.txt.buttonContent,f=n.fn.tableExport.txt.defaultClass;s(o,r,l,f)}};r.formats.forEach(function(t){c[t](l,x)})})},n.fn.tableExport.defaults={headings:!0,formats:["xls","csv","txt"],fileName:"id",bootstrap:!0,position:"bottom"},n.fn.tableExport.xlsx={defaultClass:"xlsx",buttonContent:"Export to xlsx"},n.fn.tableExport.xls={defaultClass:"xls",buttonContent:"Export to xls",separator:"	"},n.fn.tableExport.csv={defaultClass:"csv",buttonContent:"Export to csv",separator:","},n.fn.tableExport.txt={defaultClass:"txt",buttonContent:"Export to txt",separator:"  "},n.fn.tableExport.defaultFileName="myDownload",n.fn.tableExport.defaultButton="button-default",n.fn.tableExport.bootstrap=["btn","btn-default","btn-toolbar"],n.fn.tableExport.rowDel="\r\n"}(window);