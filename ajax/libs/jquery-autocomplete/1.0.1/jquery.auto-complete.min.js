// jQuery autoComplete v1.0.1
// https://github.com/Pixabay/jQuery-autoComplete
!function(e){e.fn.autoComplete=function(t){var o=e.extend({source:null,minChars:3,delay:100,cache:!0,onSelect:function(){}},t);return"string"==typeof t?void this.each(function(){var o=e(this);"destroy"==t&&(e(window).off("resize.autocomplete",o.fixPosition),o.off("keydown.autocomplete keyup.autocomplete"),o.removeAttr("autocomplete"),e(o.sb).off("mouseleave.autocomplete mouseenter.autocomplete mousedown.autocomplete mousedown.autocomplete").remove())}):this.each(function(){function t(e){var t=s.val();if(s.cache[t]=e,e.length&&t.length>=o.minChars){var l="",a=new RegExp("("+t.split(" ").join("|")+")","gi");for(i=0;i<e.length;i++)l+='<div class="autocomplete-suggestion" data-val="'+e[i]+'">'+e[i].replace(a,"<b>$1</b>")+"</div>";s.sb.html(l).show()}else s.sb.hide()}var s=e(this);s.sb=e('<div class="autocomplete-suggestions"></div>'),s.attr("autocomplete","off"),s.cache={},s.last_val="",s.fixPosition=function(){s.sb.css({top:s.offset().top+s.outerHeight(),left:s.offset().left,width:s.outerWidth()})},setTimeout(s.fixPosition,100),e(window).on("resize.autocomplete",s.fixPosition),s.fixScroll=function(t){if(s.sb.show(),s.sb.maxHeight||(s.sb.maxHeight=parseInt(s.sb.css("max-height"))),s.sb.suggestionHeight||(s.sb.suggestionHeight=e(".autocomplete-suggestion",s.sb).first().outerHeight()),s.sb.suggestionHeight)if(t){var o=s.sb.scrollTop(),l=t.offset().top-s.sb.offset().top;l+s.sb.suggestionHeight-s.sb.maxHeight>0?s.sb.scrollTop(l+s.sb.suggestionHeight+o-s.sb.maxHeight):0>l&&s.sb.scrollTop(l+o)}else s.sb.scrollTop(0)},s.sb.appendTo("body"),s.sb.on("mouseleave.autocomplete",".autocomplete-suggestion",function(){e(".autocomplete-suggestion.selected").removeClass("selected")}),s.sb.on("mouseenter.autocomplete",".autocomplete-suggestion",function(){e(".autocomplete-suggestion.selected").removeClass("selected"),e(this).addClass("selected")}),s.sb.on("mousedown.autocomplete",".autocomplete-suggestion",function(){var t=e(this).data("val");s.val(t),o.onSelect(t),setTimeout(function(){s.focus()},10)}),s.blur(function(){s.last_val=s.val(),s.sb.hide()}),s.on("keydown.autocomplete",function(t){if(40==t.which){var o,l=e(".autocomplete-suggestion.selected",s.sb);return l.length?(o=l.next(".autocomplete-suggestion"),o.length?(l.removeClass("selected"),s.val(o.addClass("selected").data("val"))):(l.removeClass("selected"),s.val(s.last_val),o=0)):(o=e(".autocomplete-suggestion",s.sb).first(),s.val(o.addClass("selected").data("val"))),s.fixScroll(o),!1}if(38==t.which){var o,l=e(".autocomplete-suggestion.selected",s.sb);if(l.length){var o=l.prev(".autocomplete-suggestion");o.length?(l.removeClass("selected"),s.val(o.addClass("selected").data("val"))):(l.removeClass("selected"),s.val(s.last_val),o=0)}else o=e(".autocomplete-suggestion",s.sb).last(),s.val(o.addClass("selected").data("val"));return s.fixScroll(o),!1}27==t.which&&s.val(s.last_val).sb.hide()}),s.on("keyup.autocomplete",function(l){if(!~e.inArray(l.which,[27,38,40,37,39])){var a=s.val();if(a.length>=o.minChars){if(a!=s.last_val){if(s.last_val=a,clearTimeout(s.timer),o.cache){if(a in s.cache)return void t(s.cache[a]);for(i=1;i<a.length-o.minChars;i++){var n=a.slice(0,a.length-i);if(n in s.cache&&!s.cache[n].length)return void t([])}}s.timer=setTimeout(function(){o.source(a,t)},o.delay)}}else s.last_val=a,s.sb.hide()}})})}}(jQuery);
