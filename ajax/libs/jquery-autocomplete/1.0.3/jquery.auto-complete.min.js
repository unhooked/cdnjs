// jQuery autoComplete v1.0.3
// https://github.com/Pixabay/jQuery-autoComplete
!function(e){e.fn.autoComplete=function(t){var s=e.extend({source:"",minChars:3,delay:100,cache:!0,menuClass:"",onSelect:function(){}},t);return"string"==typeof t?void this.each(function(){var s=e(this);"destroy"==t&&(e(window).off("resize.autocomplete",s.fixPosition),s.off("keydown.autocomplete keyup.autocomplete"),s.data("autocomplete")?s.attr("autocomplete",s.data("autocomplete")):s.removeAttr("autocomplete"),e(s.data("el")).remove(),s.removeData("el").removeData("autocomplete"))}):this.each(function(){function t(e){var t=o.val();if(o.cache[t]=e,e.length&&t.length>=s.minChars){var a="",l=new RegExp("("+t.split(" ").join("|")+")","gi");for(i=0;i<e.length;i++)a+='<div class="autocomplete-suggestion" data-val="'+e[i]+'">'+e[i].replace(l,"<b>$1</b>")+"</div>";o.sb.html(a).show()}else o.sb.hide()}var o=e(this);o.sb=e('<div class="autocomplete-suggestions"></div>').addClass(s.menuClass),o.data("el",o.sb).data("autocomplete",o.attr("autocomplete")),o.attr("autocomplete","off"),o.cache={},o.last_val="",o.fixPosition=function(){o.sb.css({top:o.offset().top+o.outerHeight(),left:o.offset().left,width:o.outerWidth()})},setTimeout(o.fixPosition,100),e(window).on("resize.autocomplete",o.fixPosition),o.fixScroll=function(t){if(o.sb.show(),o.sb.maxHeight||(o.sb.maxHeight=parseInt(o.sb.css("max-height"))),o.sb.suggestionHeight||(o.sb.suggestionHeight=e(".autocomplete-suggestion",o.sb).first().outerHeight()),o.sb.suggestionHeight)if(t){var s=o.sb.scrollTop(),a=t.offset().top-o.sb.offset().top;a+o.sb.suggestionHeight-o.sb.maxHeight>0?o.sb.scrollTop(a+o.sb.suggestionHeight+s-o.sb.maxHeight):0>a&&o.sb.scrollTop(a+s)}else o.sb.scrollTop(0)},o.sb.appendTo("body"),o.sb.on("mouseleave.autocomplete",".autocomplete-suggestion",function(){e(".autocomplete-suggestion.selected").removeClass("selected")}),o.sb.on("mouseenter.autocomplete",".autocomplete-suggestion",function(){e(".autocomplete-suggestion.selected").removeClass("selected"),e(this).addClass("selected")}),o.sb.on("mousedown.autocomplete",".autocomplete-suggestion",function(){var t=e(this).data("val");o.val(t),s.onSelect(t),setTimeout(function(){o.focus()},10)}),o.blur(function(){o.last_val=o.val(),o.sb.hide()}),o.on("keydown.autocomplete",function(t){if(40==t.which){var s,a=e(".autocomplete-suggestion.selected",o.sb);return a.length?(s=a.next(".autocomplete-suggestion"),s.length?(a.removeClass("selected"),o.val(s.addClass("selected").data("val"))):(a.removeClass("selected"),o.val(o.last_val),s=0)):(s=e(".autocomplete-suggestion",o.sb).first(),o.val(s.addClass("selected").data("val"))),o.fixScroll(s),!1}if(38==t.which){var s,a=e(".autocomplete-suggestion.selected",o.sb);if(a.length){var s=a.prev(".autocomplete-suggestion");s.length?(a.removeClass("selected"),o.val(s.addClass("selected").data("val"))):(a.removeClass("selected"),o.val(o.last_val),s=0)}else s=e(".autocomplete-suggestion",o.sb).last(),o.val(s.addClass("selected").data("val"));return o.fixScroll(s),!1}27==t.which&&o.val(o.last_val).sb.hide()}),o.on("keyup.autocomplete",function(a){if(!~e.inArray(a.which,[27,38,40,37,39])){var l=o.val();if(l.length>=s.minChars){if(l!=o.last_val){if(o.last_val=l,clearTimeout(o.timer),s.cache){if(l in o.cache)return void t(o.cache[l]);for(i=1;i<l.length-s.minChars;i++){var c=l.slice(0,l.length-i);if(c in o.cache&&!o.cache[c].length)return void t([])}}o.timer=setTimeout(function(){s.source(l,t)},s.delay)}}else o.last_val=l,o.sb.hide()}})})}}(jQuery);
